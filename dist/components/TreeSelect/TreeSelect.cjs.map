{"version":3,"file":"TreeSelect.cjs","sources":["../../../src/components/TreeSelect/TreeSelect.tsx"],"sourcesContent":["import { useState, useRef, useEffect } from 'react';\nimport type { ReactNode } from 'react';\nimport { ChevronDown, ChevronRight, Search, X } from 'lucide-react';\nimport styles from './TreeSelect.module.css';\n\nexport interface TreeSelectNode {\n  /** Unique value */\n  value: string;\n  /** Display label */\n  label: string;\n  /** Optional icon */\n  icon?: ReactNode;\n  /** Child nodes */\n  children?: TreeSelectNode[];\n  /** Disabled state */\n  disabled?: boolean;\n}\n\nexport interface TreeSelectProps {\n  /** Tree data */\n  data: TreeSelectNode[];\n  /** Selected value(s) */\n  value?: string | string[] | null;\n  /** Default value (uncontrolled) */\n  defaultValue?: string | string[] | null;\n  /** Callback when selection changes */\n  onChange?: (value: string | string[] | null) => void;\n  /** Multiple selection mode */\n  multiple?: boolean;\n  /** Show search input */\n  showSearch?: boolean;\n  /** Search placeholder */\n  searchPlaceholder?: string;\n  /** Placeholder text */\n  placeholder?: string;\n  /** Disabled state */\n  disabled?: boolean;\n  /** Additional CSS classes */\n  className?: string;\n  /** Clear button */\n  clearable?: boolean;\n}\n\n/**\n * TreeSelect - Select component with hierarchical tree data structure\n *\n * Features:\n * - Hierarchical tree selection\n * - Single and multiple selection modes\n * - Search functionality\n * - Expand/collapse nodes\n * - Icon support\n *\n * @example\n * ```tsx\n * <TreeSelect\n *   data={treeData}\n *   value={value}\n *   onChange={setValue}\n *   showSearch\n *   placeholder=\"Select location...\"\n * />\n * ```\n */\nexport const TreeSelect = ({\n  data,\n  value: controlledValue,\n  defaultValue = null,\n  onChange,\n  multiple = false,\n  showSearch = false,\n  searchPlaceholder = 'Search...',\n  placeholder = 'Select...',\n  disabled = false,\n  className = '',\n  clearable = false,\n}: TreeSelectProps) => {\n  const [uncontrolledValue, setUncontrolledValue] = useState<string | string[] | null>(\n    defaultValue\n  );\n  const [isOpen, setIsOpen] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [expandedNodes, setExpandedNodes] = useState<Set<string>>(new Set());\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const value = controlledValue !== undefined ? controlledValue : uncontrolledValue;\n\n  // Click outside to close\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleClickOutside = (event: MouseEvent) => {\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [isOpen]);\n\n  // Handle value change\n  const handleChange = (newValue: string | string[]) => {\n    if (controlledValue === undefined) {\n      setUncontrolledValue(newValue);\n    }\n    onChange?.(newValue);\n  };\n\n  // Handle node selection\n  const handleNodeSelect = (nodeValue: string) => {\n    if (disabled) return;\n\n    if (multiple) {\n      const currentValues = Array.isArray(value) ? value : value ? [value] : [];\n      const newValues = currentValues.includes(nodeValue)\n        ? currentValues.filter((v) => v !== nodeValue)\n        : [...currentValues, nodeValue];\n      handleChange(newValues);\n    } else {\n      handleChange(nodeValue);\n      setIsOpen(false);\n    }\n  };\n\n  // Toggle node expansion\n  const toggleNode = (nodeValue: string) => {\n    setExpandedNodes((prev) => {\n      const next = new Set(prev);\n      if (next.has(nodeValue)) {\n        next.delete(nodeValue);\n      } else {\n        next.add(nodeValue);\n      }\n      return next;\n    });\n  };\n\n  // Get selected labels\n  const getSelectedLabels = (): string => {\n    if (!value) return '';\n\n    const values = Array.isArray(value) ? value : [value];\n    const labels: string[] = [];\n\n    const findLabels = (nodes: TreeSelectNode[]) => {\n      nodes.forEach((node) => {\n        if (values.includes(node.value)) {\n          labels.push(node.label);\n        }\n        if (node.children) {\n          findLabels(node.children);\n        }\n      });\n    };\n\n    findLabels(data);\n    return labels.join(', ');\n  };\n\n  // Filter tree by search\n  const filterTree = (nodes: TreeSelectNode[], query: string): TreeSelectNode[] => {\n    if (!query) return nodes;\n\n    const q = query.toLowerCase();\n    const filtered: TreeSelectNode[] = [];\n\n    nodes.forEach((node) => {\n      const matches = node.label.toLowerCase().includes(q);\n      const filteredChildren = node.children ? filterTree(node.children, query) : [];\n\n      if (matches || filteredChildren.length > 0) {\n        filtered.push({\n          ...node,\n          children: filteredChildren.length > 0 ? filteredChildren : node.children,\n        });\n\n        // Auto-expand nodes with matches\n        if (filteredChildren.length > 0) {\n          setExpandedNodes((prev) => new Set(prev).add(node.value));\n        }\n      }\n    });\n\n    return filtered;\n  };\n\n  const filteredData = filterTree(data, searchQuery);\n\n  // Render tree node\n  const renderNode = (node: TreeSelectNode, level: number = 0): ReactNode => {\n    const hasChildren = node.children && node.children.length > 0;\n    const isExpanded = expandedNodes.has(node.value);\n    const isSelected = multiple\n      ? Array.isArray(value) && value.includes(node.value)\n      : value === node.value;\n\n    return (\n      <div key={node.value} className={styles.treeNode}>\n        <div\n          className={`${styles.treeNodeContent} ${isSelected ? styles.treeNodeSelected : ''} ${\n            node.disabled ? styles.treeNodeDisabled : ''\n          }`}\n          style={{ paddingLeft: `${level * 20 + 8}px` }}\n        >\n          {hasChildren ? (\n            <button\n              className={styles.treeExpandBtn}\n              onClick={() => toggleNode(node.value)}\n              aria-label={isExpanded ? 'Collapse' : 'Expand'}\n            >\n              {isExpanded ? <ChevronDown size={16} /> : <ChevronRight size={16} />}\n            </button>\n          ) : (\n            <span className={styles.treeIndent} />\n          )}\n\n          {multiple && (\n            <input\n              type=\"checkbox\"\n              className={styles.treeCheckbox}\n              checked={isSelected}\n              onChange={() => handleNodeSelect(node.value)}\n              disabled={disabled || node.disabled}\n            />\n          )}\n\n          <div\n            className={styles.treeLabel}\n            onClick={() => !multiple && handleNodeSelect(node.value)}\n            role={!multiple ? 'button' : undefined}\n          >\n            {node.icon && <span className={styles.treeIcon}>{node.icon}</span>}\n            <span>{node.label}</span>\n          </div>\n        </div>\n\n        {hasChildren && isExpanded && (\n          <div className={styles.treeChildren}>\n            {node.children!.map((child) => renderNode(child, level + 1))}\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  // Clear selection\n  const handleClear = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    handleChange(multiple ? [] : '');\n  };\n\n  const selectedLabel = getSelectedLabels();\n  const showClearButton = clearable && !disabled && selectedLabel;\n\n  return (\n    <div className={`${styles.treeselect} ${className}`} ref={containerRef}>\n      {/* Trigger */}\n      <div\n        className={`${styles.treeselectTrigger} ${disabled ? styles.disabled : ''}`}\n        onClick={() => !disabled && setIsOpen(!isOpen)}\n        role=\"combobox\"\n        aria-expanded={isOpen}\n        aria-haspopup=\"tree\"\n        tabIndex={disabled ? -1 : 0}\n      >\n        <span className={`${styles.treeselectValue} ${!selectedLabel ? styles.placeholder : ''}`}>\n          {selectedLabel || placeholder}\n        </span>\n        <div className={styles.treeselectIcons}>\n          {showClearButton && (\n            <button\n              className={styles.treeselectClearBtn}\n              onClick={handleClear}\n              aria-label=\"Clear selection\"\n            >\n              <X size={16} />\n            </button>\n          )}\n          <ChevronDown\n            className={`${styles.treeselectIcon} ${isOpen ? styles.treeselectIconOpen : ''}`}\n            size={16}\n          />\n        </div>\n      </div>\n\n      {/* Dropdown */}\n      {isOpen && (\n        <div className={styles.treeselectDropdown}>\n          {showSearch && (\n            <div className={styles.treeselectSearch}>\n              <Search className={styles.treeselectSearchIcon} size={16} />\n              <input\n                type=\"text\"\n                className={styles.treeselectSearchInput}\n                placeholder={searchPlaceholder}\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n              />\n            </div>\n          )}\n\n          <div className={styles.treeselectTree}>\n            {filteredData.length === 0 ? (\n              <div className={styles.treeselectEmpty}>No results found</div>\n            ) : (\n              filteredData.map((node) => renderNode(node))\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n"],"names":["TreeSelect","data","controlledValue","defaultValue","onChange","multiple","showSearch","searchPlaceholder","placeholder","disabled","className","clearable","uncontrolledValue","setUncontrolledValue","useState","isOpen","setIsOpen","searchQuery","setSearchQuery","expandedNodes","setExpandedNodes","containerRef","useRef","value","useEffect","handleClickOutside","event","handleChange","newValue","handleNodeSelect","nodeValue","currentValues","newValues","v","toggleNode","prev","next","getSelectedLabels","values","labels","findLabels","nodes","node","filterTree","query","q","filtered","matches","filteredChildren","filteredData","renderNode","level","hasChildren","isExpanded","isSelected","jsxs","styles","jsx","ChevronDown","ChevronRight","child","handleClear","selectedLabel","showClearButton","X","Search"],"mappings":"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"}