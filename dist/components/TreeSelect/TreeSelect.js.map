{"version":3,"file":"TreeSelect.js","sources":["../../../src/components/TreeSelect/TreeSelect.tsx"],"sourcesContent":["import { useState, useRef, useEffect } from 'react';\nimport type { ReactNode } from 'react';\nimport { ChevronDown, ChevronRight, Search, X } from 'lucide-react';\nimport styles from './TreeSelect.module.css';\n\nexport interface TreeSelectNode {\n  /** Unique value */\n  value: string;\n  /** Display label */\n  label: string;\n  /** Optional icon */\n  icon?: ReactNode;\n  /** Child nodes */\n  children?: TreeSelectNode[];\n  /** Disabled state */\n  disabled?: boolean;\n}\n\nexport interface TreeSelectProps {\n  /** Tree data */\n  data: TreeSelectNode[];\n  /** Selected value(s) */\n  value?: string | string[] | null;\n  /** Default value (uncontrolled) */\n  defaultValue?: string | string[] | null;\n  /** Callback when selection changes */\n  onChange?: (value: string | string[] | null) => void;\n  /** Multiple selection mode */\n  multiple?: boolean;\n  /** Show search input */\n  showSearch?: boolean;\n  /** Search placeholder */\n  searchPlaceholder?: string;\n  /** Placeholder text */\n  placeholder?: string;\n  /** Disabled state */\n  disabled?: boolean;\n  /** Additional CSS classes */\n  className?: string;\n  /** Clear button */\n  clearable?: boolean;\n}\n\n/**\n * TreeSelect - Select component with hierarchical tree data structure\n *\n * Features:\n * - Hierarchical tree selection\n * - Single and multiple selection modes\n * - Search functionality\n * - Expand/collapse nodes\n * - Icon support\n *\n * @example\n * ```tsx\n * <TreeSelect\n *   data={treeData}\n *   value={value}\n *   onChange={setValue}\n *   showSearch\n *   placeholder=\"Select location...\"\n * />\n * ```\n */\nexport const TreeSelect = ({\n  data,\n  value: controlledValue,\n  defaultValue = null,\n  onChange,\n  multiple = false,\n  showSearch = false,\n  searchPlaceholder = 'Search...',\n  placeholder = 'Select...',\n  disabled = false,\n  className = '',\n  clearable = false,\n}: TreeSelectProps) => {\n  const [uncontrolledValue, setUncontrolledValue] = useState<string | string[] | null>(\n    defaultValue\n  );\n  const [isOpen, setIsOpen] = useState(false);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [expandedNodes, setExpandedNodes] = useState<Set<string>>(new Set());\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const value = controlledValue !== undefined ? controlledValue : uncontrolledValue;\n\n  // Click outside to close\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleClickOutside = (event: MouseEvent) => {\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [isOpen]);\n\n  // Handle value change\n  const handleChange = (newValue: string | string[]) => {\n    if (controlledValue === undefined) {\n      setUncontrolledValue(newValue);\n    }\n    onChange?.(newValue);\n  };\n\n  // Handle node selection\n  const handleNodeSelect = (nodeValue: string) => {\n    if (disabled) return;\n\n    if (multiple) {\n      const currentValues = Array.isArray(value) ? value : value ? [value] : [];\n      const newValues = currentValues.includes(nodeValue)\n        ? currentValues.filter((v) => v !== nodeValue)\n        : [...currentValues, nodeValue];\n      handleChange(newValues);\n    } else {\n      handleChange(nodeValue);\n      setIsOpen(false);\n    }\n  };\n\n  // Toggle node expansion\n  const toggleNode = (nodeValue: string) => {\n    setExpandedNodes((prev) => {\n      const next = new Set(prev);\n      if (next.has(nodeValue)) {\n        next.delete(nodeValue);\n      } else {\n        next.add(nodeValue);\n      }\n      return next;\n    });\n  };\n\n  // Get selected labels\n  const getSelectedLabels = (): string => {\n    if (!value) return '';\n\n    const values = Array.isArray(value) ? value : [value];\n    const labels: string[] = [];\n\n    const findLabels = (nodes: TreeSelectNode[]) => {\n      nodes.forEach((node) => {\n        if (values.includes(node.value)) {\n          labels.push(node.label);\n        }\n        if (node.children) {\n          findLabels(node.children);\n        }\n      });\n    };\n\n    findLabels(data);\n    return labels.join(', ');\n  };\n\n  // Filter tree by search\n  const filterTree = (nodes: TreeSelectNode[], query: string): TreeSelectNode[] => {\n    if (!query) return nodes;\n\n    const q = query.toLowerCase();\n    const filtered: TreeSelectNode[] = [];\n\n    nodes.forEach((node) => {\n      const matches = node.label.toLowerCase().includes(q);\n      const filteredChildren = node.children ? filterTree(node.children, query) : [];\n\n      if (matches || filteredChildren.length > 0) {\n        filtered.push({\n          ...node,\n          children: filteredChildren.length > 0 ? filteredChildren : node.children,\n        });\n\n        // Auto-expand nodes with matches\n        if (filteredChildren.length > 0) {\n          setExpandedNodes((prev) => new Set(prev).add(node.value));\n        }\n      }\n    });\n\n    return filtered;\n  };\n\n  const filteredData = filterTree(data, searchQuery);\n\n  // Render tree node\n  const renderNode = (node: TreeSelectNode, level: number = 0): ReactNode => {\n    const hasChildren = node.children && node.children.length > 0;\n    const isExpanded = expandedNodes.has(node.value);\n    const isSelected = multiple\n      ? Array.isArray(value) && value.includes(node.value)\n      : value === node.value;\n\n    return (\n      <div key={node.value} className={styles.treeNode}>\n        <div\n          className={`${styles.treeNodeContent} ${isSelected ? styles.treeNodeSelected : ''} ${\n            node.disabled ? styles.treeNodeDisabled : ''\n          }`}\n          style={{ paddingLeft: `${level * 20 + 8}px` }}\n        >\n          {hasChildren ? (\n            <button\n              className={styles.treeExpandBtn}\n              onClick={() => toggleNode(node.value)}\n              aria-label={isExpanded ? 'Collapse' : 'Expand'}\n            >\n              {isExpanded ? <ChevronDown size={16} /> : <ChevronRight size={16} />}\n            </button>\n          ) : (\n            <span className={styles.treeIndent} />\n          )}\n\n          {multiple && (\n            <input\n              type=\"checkbox\"\n              className={styles.treeCheckbox}\n              checked={isSelected}\n              onChange={() => handleNodeSelect(node.value)}\n              disabled={disabled || node.disabled}\n            />\n          )}\n\n          <div\n            className={styles.treeLabel}\n            onClick={() => !multiple && handleNodeSelect(node.value)}\n            role={!multiple ? 'button' : undefined}\n          >\n            {node.icon && <span className={styles.treeIcon}>{node.icon}</span>}\n            <span>{node.label}</span>\n          </div>\n        </div>\n\n        {hasChildren && isExpanded && (\n          <div className={styles.treeChildren}>\n            {node.children!.map((child) => renderNode(child, level + 1))}\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  // Clear selection\n  const handleClear = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    handleChange(multiple ? [] : '');\n  };\n\n  const selectedLabel = getSelectedLabels();\n  const showClearButton = clearable && !disabled && selectedLabel;\n\n  return (\n    <div className={`${styles.treeselect} ${className}`} ref={containerRef}>\n      {/* Trigger */}\n      <div\n        className={`${styles.treeselectTrigger} ${disabled ? styles.disabled : ''}`}\n        onClick={() => !disabled && setIsOpen(!isOpen)}\n        role=\"combobox\"\n        aria-expanded={isOpen}\n        aria-haspopup=\"tree\"\n        tabIndex={disabled ? -1 : 0}\n      >\n        <span className={`${styles.treeselectValue} ${!selectedLabel ? styles.placeholder : ''}`}>\n          {selectedLabel || placeholder}\n        </span>\n        <div className={styles.treeselectIcons}>\n          {showClearButton && (\n            <button\n              className={styles.treeselectClearBtn}\n              onClick={handleClear}\n              aria-label=\"Clear selection\"\n            >\n              <X size={16} />\n            </button>\n          )}\n          <ChevronDown\n            className={`${styles.treeselectIcon} ${isOpen ? styles.treeselectIconOpen : ''}`}\n            size={16}\n          />\n        </div>\n      </div>\n\n      {/* Dropdown */}\n      {isOpen && (\n        <div className={styles.treeselectDropdown}>\n          {showSearch && (\n            <div className={styles.treeselectSearch}>\n              <Search className={styles.treeselectSearchIcon} size={16} />\n              <input\n                type=\"text\"\n                className={styles.treeselectSearchInput}\n                placeholder={searchPlaceholder}\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n              />\n            </div>\n          )}\n\n          <div className={styles.treeselectTree}>\n            {filteredData.length === 0 ? (\n              <div className={styles.treeselectEmpty}>No results found</div>\n            ) : (\n              filteredData.map((node) => renderNode(node))\n            )}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n"],"names":["TreeSelect","data","controlledValue","defaultValue","onChange","multiple","showSearch","searchPlaceholder","placeholder","disabled","className","clearable","uncontrolledValue","setUncontrolledValue","useState","isOpen","setIsOpen","searchQuery","setSearchQuery","expandedNodes","setExpandedNodes","containerRef","useRef","value","useEffect","handleClickOutside","event","handleChange","newValue","handleNodeSelect","nodeValue","currentValues","newValues","v","toggleNode","prev","next","getSelectedLabels","values","labels","findLabels","nodes","node","filterTree","query","q","filtered","matches","filteredChildren","filteredData","renderNode","level","hasChildren","isExpanded","isSelected","jsxs","styles","jsx","ChevronDown","ChevronRight","child","handleClear","selectedLabel","showClearButton","X","Search"],"mappings":"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"}