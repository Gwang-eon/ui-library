{"version":3,"file":"Modal.js","sources":["../../../src/components/Modal/Modal.tsx"],"sourcesContent":["import React, { useEffect, useRef, useCallback } from 'react';\nimport { createPortal } from 'react-dom';\nimport { X } from 'lucide-react';\nimport styles from './Modal.module.css';\n\nexport interface ModalProps {\n  open: boolean;\n  onClose: () => void;\n  children: React.ReactNode;\n  size?: 'sm' | 'md' | 'lg' | 'full';\n  closeOnOverlayClick?: boolean;\n  closeOnEscape?: boolean;\n  className?: string;\n}\n\nexport interface ModalHeaderProps {\n  children: React.ReactNode;\n  onClose?: () => void;\n  showCloseButton?: boolean;\n  className?: string;\n}\n\nexport interface ModalBodyProps {\n  children: React.ReactNode;\n  className?: string;\n  style?: React.CSSProperties;\n}\n\nexport interface ModalFooterProps {\n  children: React.ReactNode;\n  className?: string;\n}\n\nconst Modal = ({\n  open,\n  onClose,\n  children,\n  size = 'md',\n  closeOnOverlayClick = true,\n  closeOnEscape = true,\n  className = '',\n}: ModalProps) => {\n  const modalRef = useRef<HTMLDivElement>(null);\n  const previousActiveElement = useRef<HTMLElement | null>(null);\n\n  // Store the previously focused element\n  useEffect(() => {\n    if (open) {\n      previousActiveElement.current = document.activeElement as HTMLElement;\n    }\n  }, [open]);\n\n  // Handle escape key\n  useEffect(() => {\n    if (!open || !closeOnEscape) return;\n\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        onClose();\n      }\n    };\n\n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [open, closeOnEscape, onClose]);\n\n  // Prevent body scroll when modal is open\n  useEffect(() => {\n    if (open) {\n      document.body.style.overflow = 'hidden';\n\n      // Focus the modal\n      if (modalRef.current) {\n        const firstFocusable = modalRef.current.querySelector<HTMLElement>(\n          'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n        );\n        if (firstFocusable) {\n          setTimeout(() => firstFocusable.focus(), 100);\n        }\n      }\n    } else {\n      document.body.style.overflow = '';\n\n      // Restore focus to the previously focused element\n      if (previousActiveElement.current) {\n        previousActiveElement.current.focus();\n      }\n    }\n\n    return () => {\n      document.body.style.overflow = '';\n    };\n  }, [open]);\n\n  // Focus trap\n  useEffect(() => {\n    if (!open || !modalRef.current) return;\n\n    const handleTabKey = (e: KeyboardEvent) => {\n      if (e.key !== 'Tab' || !modalRef.current) return;\n\n      const focusableElements = modalRef.current.querySelectorAll<HTMLElement>(\n        'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n      );\n\n      const firstElement = focusableElements[0];\n      const lastElement = focusableElements[focusableElements.length - 1];\n\n      if (e.shiftKey) {\n        if (document.activeElement === firstElement) {\n          e.preventDefault();\n          lastElement?.focus();\n        }\n      } else {\n        if (document.activeElement === lastElement) {\n          e.preventDefault();\n          firstElement?.focus();\n        }\n      }\n    };\n\n    document.addEventListener('keydown', handleTabKey);\n    return () => document.removeEventListener('keydown', handleTabKey);\n  }, [open]);\n\n  const handleOverlayClick = useCallback(\n    (e: React.MouseEvent<HTMLDivElement>) => {\n      if (closeOnOverlayClick && e.target === e.currentTarget) {\n        onClose();\n      }\n    },\n    [closeOnOverlayClick, onClose]\n  );\n\n  if (!open) return null;\n\n  const sizeClass = size === 'sm' ? styles.modalSm :\n                    size === 'lg' ? styles.modalLg :\n                    size === 'full' ? styles.modalFull : styles.modalMd;\n\n  return createPortal(\n    <div\n      className={styles.modalOverlay}\n      onClick={handleOverlayClick}\n      role=\"presentation\"\n    >\n      <div\n        ref={modalRef}\n        className={`${styles.modal} ${sizeClass} ${className}`}\n        role=\"dialog\"\n        aria-modal=\"true\"\n      >\n        {children}\n      </div>\n    </div>,\n    document.body\n  );\n};\n\nconst ModalHeader = ({\n  children,\n  onClose,\n  showCloseButton = true,\n  className = '',\n}: ModalHeaderProps) => {\n  return (\n    <div className={`${styles.modalHeader} ${className}`}>\n      {children}\n      {showCloseButton && onClose && (\n        <button\n          className={styles.modalClose}\n          onClick={onClose}\n          aria-label=\"Close\"\n        >\n          <X size={20} />\n        </button>\n      )}\n    </div>\n  );\n};\n\nconst ModalTitle = ({ children }: { children: React.ReactNode }) => {\n  return <h3 className={styles.modalTitle}>{children}</h3>;\n};\n\nconst ModalBody = ({ children, className = '', style }: ModalBodyProps) => {\n  return <div className={`${styles.modalBody} ${className}`} style={style}>{children}</div>;\n};\n\nconst ModalFooter = ({ children, className = '' }: ModalFooterProps) => {\n  return <div className={`${styles.modalFooter} ${className}`}>{children}</div>;\n};\n\nModal.displayName = 'Modal';\nModalHeader.displayName = 'ModalHeader';\nModalTitle.displayName = 'ModalTitle';\nModalBody.displayName = 'ModalBody';\nModalFooter.displayName = 'ModalFooter';\n\nexport { Modal, ModalHeader, ModalTitle, ModalBody, ModalFooter };\n"],"names":["Modal","open","onClose","children","size","closeOnOverlayClick","closeOnEscape","className","modalRef","useRef","previousActiveElement","useEffect","handleEscape","e","firstFocusable","handleTabKey","focusableElements","firstElement","lastElement","handleOverlayClick","useCallback","sizeClass","styles","createPortal","jsx","ModalHeader","showCloseButton","jsxs","X","ModalTitle","ModalBody","style","ModalFooter"],"mappings":"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"}