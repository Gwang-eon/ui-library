{"version":3,"file":"Select.cjs","sources":["../../../src/components/Select/Select.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect, type ReactNode } from 'react';\nimport { ChevronDown } from 'lucide-react';\nimport styles from './Select.module.css';\n\nexport interface SelectOption {\n  value: string;\n  label: string;\n  icon?: ReactNode;\n  disabled?: boolean;\n}\n\nexport interface SelectOptionGroup {\n  label: string;\n  options: SelectOption[];\n}\n\nexport type SelectState = 'default' | 'error';\nexport type SelectSize = 'sm' | 'md' | 'lg';\n\nexport interface SelectProps {\n  label?: string;\n  name?: string;\n  value?: string;\n  defaultValue?: string;\n  placeholder?: string;\n  options?: SelectOption[];\n  groups?: SelectOptionGroup[];\n  state?: SelectState;\n  size?: SelectSize;\n  disabled?: boolean;\n  helperText?: string;\n  errorMessage?: string;\n  required?: boolean;\n  fullWidth?: boolean;\n  onChange?: (value: string, option: SelectOption | null) => void;\n  className?: string;\n  id?: string;\n}\n\nexport const Select = React.forwardRef<HTMLDivElement, SelectProps>(\n  (\n    {\n      label,\n      name,\n      value: controlledValue,\n      defaultValue = '',\n      placeholder = 'Select an option...',\n      options = [],\n      groups = [],\n      state = 'default',\n      size = 'md',\n      disabled = false,\n      helperText,\n      errorMessage,\n      required = false,\n      fullWidth = false,\n      onChange,\n      className = '',\n      id,\n    },\n    ref\n  ) => {\n    const selectId = id || `select-${React.useId()}`;\n    const [isOpen, setIsOpen] = useState(false);\n    const [selectedValue, setSelectedValue] = useState(controlledValue ?? defaultValue);\n    const [focusedIndex, setFocusedIndex] = useState(-1);\n    const containerRef = useRef<HTMLDivElement>(null);\n    const dropdownRef = useRef<HTMLDivElement>(null);\n    const triggerRef = useRef<HTMLDivElement>(null);\n\n    // Determine if controlled or uncontrolled\n    const isControlled = controlledValue !== undefined;\n    const currentValue = isControlled ? controlledValue : selectedValue;\n\n    // Flatten all options (from both options and groups)\n    const allOptions = React.useMemo(() => {\n      const opts: SelectOption[] = [...options];\n      groups.forEach((group) => {\n        opts.push(...group.options);\n      });\n      return opts.filter((opt) => !opt.disabled);\n    }, [options, groups]);\n\n    // Find selected option\n    const selectedOption = allOptions.find((opt) => opt.value === currentValue);\n\n    // Handle value change\n    const handleValueChange = (newValue: string) => {\n      if (!isControlled) {\n        setSelectedValue(newValue);\n      }\n      const option = allOptions.find((opt) => opt.value === newValue) || null;\n      onChange?.(newValue, option);\n    };\n\n    // Toggle dropdown\n    const toggleDropdown = () => {\n      if (!disabled) {\n        setIsOpen((prev) => !prev);\n        setFocusedIndex(-1);\n      }\n    };\n\n    // Handle option click\n    const handleOptionClick = (option: SelectOption) => {\n      if (!option.disabled) {\n        handleValueChange(option.value);\n        setIsOpen(false);\n        triggerRef.current?.focus();\n      }\n    };\n\n    // Close dropdown when clicking outside\n    useEffect(() => {\n      const handleClickOutside = (event: MouseEvent) => {\n        if (\n          containerRef.current &&\n          !containerRef.current.contains(event.target as Node)\n        ) {\n          setIsOpen(false);\n        }\n      };\n\n      if (isOpen) {\n        document.addEventListener('mousedown', handleClickOutside);\n        return () => {\n          document.removeEventListener('mousedown', handleClickOutside);\n        };\n      }\n    }, [isOpen]);\n\n    // Keyboard navigation\n    const handleKeyDown = (event: React.KeyboardEvent) => {\n      if (disabled) return;\n\n      switch (event.key) {\n        case 'Enter':\n        case ' ':\n          event.preventDefault();\n          if (!isOpen) {\n            setIsOpen(true);\n          } else if (focusedIndex >= 0 && focusedIndex < allOptions.length) {\n            handleOptionClick(allOptions[focusedIndex]);\n          }\n          break;\n        case 'Escape':\n          event.preventDefault();\n          setIsOpen(false);\n          triggerRef.current?.focus();\n          break;\n        case 'ArrowDown':\n          event.preventDefault();\n          if (!isOpen) {\n            setIsOpen(true);\n          } else {\n            setFocusedIndex((prev) =>\n              prev < allOptions.length - 1 ? prev + 1 : prev\n            );\n          }\n          break;\n        case 'ArrowUp':\n          event.preventDefault();\n          if (isOpen) {\n            setFocusedIndex((prev) => (prev > 0 ? prev - 1 : 0));\n          }\n          break;\n        case 'Tab':\n          if (isOpen) {\n            setIsOpen(false);\n          }\n          break;\n      }\n    };\n\n    // Auto-scroll focused option into view\n    useEffect(() => {\n      if (isOpen && focusedIndex >= 0 && dropdownRef.current) {\n        const focusedElement = dropdownRef.current.children[focusedIndex] as HTMLElement;\n        if (focusedElement) {\n          focusedElement.scrollIntoView({ block: 'nearest', behavior: 'smooth' });\n        }\n      }\n    }, [focusedIndex, isOpen]);\n\n    // Render options from array\n    const renderOptions = (opts: SelectOption[]) => {\n      return opts.map((option) => {\n        const globalIndex = allOptions.indexOf(option);\n        const isSelected = option.value === currentValue;\n        const isFocused = globalIndex === focusedIndex;\n\n        return (\n          <div\n            key={option.value}\n            className={`${styles['custom-select-option']} ${\n              isSelected ? styles.selected : ''\n            } ${isFocused ? styles.focused : ''} ${\n              option.disabled ? styles.disabled : ''\n            }`}\n            onClick={() => handleOptionClick(option)}\n            role=\"option\"\n            aria-selected={isSelected}\n            data-value={option.value}\n          >\n            {option.icon && <span className={styles['option-icon']}>{option.icon}</span>}\n            <span>{option.label}</span>\n          </div>\n        );\n      });\n    };\n\n    // Render dropdown content\n    const renderDropdown = () => {\n      if (groups.length > 0) {\n        return groups.map((group) => (\n          <React.Fragment key={group.label}>\n            <div className={styles['custom-select-group-label']}>{group.label}</div>\n            {renderOptions(group.options)}\n          </React.Fragment>\n        ));\n      }\n      return renderOptions(options);\n    };\n\n    return (\n      <div\n        ref={(node) => {\n          if (typeof ref === 'function') {\n            ref(node);\n          } else if (ref) {\n            ref.current = node;\n          }\n          (containerRef as React.MutableRefObject<HTMLDivElement | null>).current = node;\n        }}\n        className={`${styles['input-group']} ${fullWidth ? styles['input-full-width'] : ''} ${className}`}\n      >\n        {label && (\n          <label htmlFor={selectId} className={styles['input-label']}>\n            {label}\n            {required && <span className={styles.required}>*</span>}\n          </label>\n        )}\n\n        <div\n          className={`${styles['custom-select']} ${\n            isOpen ? styles.open : ''\n          } ${state === 'error' ? styles.error : ''} ${\n            disabled ? styles.disabled : ''\n          } ${styles[`select-${size}`] || ''}`}\n        >\n          {/* Hidden native select for form submission */}\n          <select\n            id={selectId}\n            name={name}\n            value={currentValue}\n            onChange={() => {}}\n            className={styles['native-select']}\n            disabled={disabled}\n            required={required}\n            tabIndex={-1}\n            aria-hidden=\"true\"\n          >\n            <option value=\"\">{placeholder}</option>\n            {allOptions.map((option) => (\n              <option key={option.value} value={option.value}>\n                {option.label}\n              </option>\n            ))}\n          </select>\n\n          {/* Custom trigger */}\n          <div\n            ref={triggerRef}\n            className={`${styles['custom-select-trigger']} ${\n              !selectedOption ? styles.placeholder : ''\n            }`}\n            onClick={toggleDropdown}\n            onKeyDown={handleKeyDown}\n            tabIndex={disabled ? -1 : 0}\n            role=\"combobox\"\n            aria-expanded={isOpen}\n            aria-haspopup=\"listbox\"\n            aria-controls={`${selectId}-listbox`}\n            aria-labelledby={label ? `${selectId}-label` : undefined}\n            aria-disabled={disabled}\n          >\n            <span className={styles['trigger-content']}>\n              {selectedOption?.icon && (\n                <span className={styles['option-icon']}>{selectedOption.icon}</span>\n              )}\n              {selectedOption ? selectedOption.label : placeholder}\n            </span>\n            <ChevronDown className={styles['select-icon']} size={18} />\n          </div>\n\n          {/* Dropdown */}\n          <div\n            ref={dropdownRef}\n            className={styles['custom-select-dropdown']}\n            role=\"listbox\"\n            id={`${selectId}-listbox`}\n            aria-labelledby={label ? `${selectId}-label` : undefined}\n          >\n            {renderDropdown()}\n          </div>\n        </div>\n\n        {/* Helper text or error message */}\n        {state === 'error' && errorMessage && (\n          <span className={`${styles['input-message']} ${styles['input-error']}`}>\n            {errorMessage}\n          </span>\n        )}\n        {state !== 'error' && helperText && (\n          <span className={styles['input-message']}>{helperText}</span>\n        )}\n      </div>\n    );\n  }\n);\n\nSelect.displayName = 'Select';\n"],"names":["Select","React","label","name","controlledValue","defaultValue","placeholder","options","groups","state","size","disabled","helperText","errorMessage","required","fullWidth","onChange","className","id","ref","selectId","isOpen","setIsOpen","useState","selectedValue","setSelectedValue","focusedIndex","setFocusedIndex","containerRef","useRef","dropdownRef","triggerRef","isControlled","currentValue","allOptions","opts","group","opt","selectedOption","handleValueChange","newValue","option","toggleDropdown","prev","handleOptionClick","useEffect","handleClickOutside","event","handleKeyDown","focusedElement","renderOptions","globalIndex","isSelected","isFocused","jsxs","styles","jsx","renderDropdown","node","ChevronDown"],"mappings":"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"}