{"version":3,"file":"Select.js","sources":["../../../src/components/Select/Select.tsx"],"sourcesContent":["import React, { useState, useRef, useEffect, type ReactNode } from 'react';\nimport { ChevronDown } from 'lucide-react';\nimport styles from './Select.module.css';\n\nexport interface SelectOption {\n  value: string;\n  label: string;\n  icon?: ReactNode;\n  disabled?: boolean;\n}\n\nexport interface SelectOptionGroup {\n  label: string;\n  options: SelectOption[];\n}\n\nexport type SelectState = 'default' | 'error';\nexport type SelectSize = 'sm' | 'md' | 'lg';\n\nexport interface SelectProps {\n  label?: string;\n  name?: string;\n  value?: string;\n  defaultValue?: string;\n  placeholder?: string;\n  options?: SelectOption[];\n  groups?: SelectOptionGroup[];\n  state?: SelectState;\n  size?: SelectSize;\n  disabled?: boolean;\n  helperText?: string;\n  errorMessage?: string;\n  required?: boolean;\n  fullWidth?: boolean;\n  onChange?: (value: string, option: SelectOption | null) => void;\n  className?: string;\n  id?: string;\n}\n\nexport const Select = React.forwardRef<HTMLDivElement, SelectProps>(\n  (\n    {\n      label,\n      name,\n      value: controlledValue,\n      defaultValue = '',\n      placeholder = 'Select an option...',\n      options = [],\n      groups = [],\n      state = 'default',\n      size = 'md',\n      disabled = false,\n      helperText,\n      errorMessage,\n      required = false,\n      fullWidth = false,\n      onChange,\n      className = '',\n      id,\n    },\n    ref\n  ) => {\n    const selectId = id || `select-${React.useId()}`;\n    const [isOpen, setIsOpen] = useState(false);\n    const [selectedValue, setSelectedValue] = useState(controlledValue ?? defaultValue);\n    const [focusedIndex, setFocusedIndex] = useState(-1);\n    const containerRef = useRef<HTMLDivElement>(null);\n    const dropdownRef = useRef<HTMLDivElement>(null);\n    const triggerRef = useRef<HTMLDivElement>(null);\n\n    // Determine if controlled or uncontrolled\n    const isControlled = controlledValue !== undefined;\n    const currentValue = isControlled ? controlledValue : selectedValue;\n\n    // Flatten all options (from both options and groups)\n    const allOptions = React.useMemo(() => {\n      const opts: SelectOption[] = [...options];\n      groups.forEach((group) => {\n        opts.push(...group.options);\n      });\n      return opts.filter((opt) => !opt.disabled);\n    }, [options, groups]);\n\n    // Find selected option\n    const selectedOption = allOptions.find((opt) => opt.value === currentValue);\n\n    // Handle value change\n    const handleValueChange = (newValue: string) => {\n      if (!isControlled) {\n        setSelectedValue(newValue);\n      }\n      const option = allOptions.find((opt) => opt.value === newValue) || null;\n      onChange?.(newValue, option);\n    };\n\n    // Toggle dropdown\n    const toggleDropdown = () => {\n      if (!disabled) {\n        setIsOpen((prev) => !prev);\n        setFocusedIndex(-1);\n      }\n    };\n\n    // Handle option click\n    const handleOptionClick = (option: SelectOption) => {\n      if (!option.disabled) {\n        handleValueChange(option.value);\n        setIsOpen(false);\n        triggerRef.current?.focus();\n      }\n    };\n\n    // Close dropdown when clicking outside\n    useEffect(() => {\n      const handleClickOutside = (event: MouseEvent) => {\n        if (\n          containerRef.current &&\n          !containerRef.current.contains(event.target as Node)\n        ) {\n          setIsOpen(false);\n        }\n      };\n\n      if (isOpen) {\n        document.addEventListener('mousedown', handleClickOutside);\n        return () => {\n          document.removeEventListener('mousedown', handleClickOutside);\n        };\n      }\n    }, [isOpen]);\n\n    // Keyboard navigation\n    const handleKeyDown = (event: React.KeyboardEvent) => {\n      if (disabled) return;\n\n      switch (event.key) {\n        case 'Enter':\n        case ' ':\n          event.preventDefault();\n          if (!isOpen) {\n            setIsOpen(true);\n          } else if (focusedIndex >= 0 && focusedIndex < allOptions.length) {\n            handleOptionClick(allOptions[focusedIndex]);\n          }\n          break;\n        case 'Escape':\n          event.preventDefault();\n          setIsOpen(false);\n          triggerRef.current?.focus();\n          break;\n        case 'ArrowDown':\n          event.preventDefault();\n          if (!isOpen) {\n            setIsOpen(true);\n          } else {\n            setFocusedIndex((prev) =>\n              prev < allOptions.length - 1 ? prev + 1 : prev\n            );\n          }\n          break;\n        case 'ArrowUp':\n          event.preventDefault();\n          if (isOpen) {\n            setFocusedIndex((prev) => (prev > 0 ? prev - 1 : 0));\n          }\n          break;\n        case 'Tab':\n          if (isOpen) {\n            setIsOpen(false);\n          }\n          break;\n      }\n    };\n\n    // Auto-scroll focused option into view\n    useEffect(() => {\n      if (isOpen && focusedIndex >= 0 && dropdownRef.current) {\n        const focusedElement = dropdownRef.current.children[focusedIndex] as HTMLElement;\n        if (focusedElement) {\n          focusedElement.scrollIntoView({ block: 'nearest', behavior: 'smooth' });\n        }\n      }\n    }, [focusedIndex, isOpen]);\n\n    // Render options from array\n    const renderOptions = (opts: SelectOption[]) => {\n      return opts.map((option) => {\n        const globalIndex = allOptions.indexOf(option);\n        const isSelected = option.value === currentValue;\n        const isFocused = globalIndex === focusedIndex;\n\n        return (\n          <div\n            key={option.value}\n            className={`${styles['custom-select-option']} ${\n              isSelected ? styles.selected : ''\n            } ${isFocused ? styles.focused : ''} ${\n              option.disabled ? styles.disabled : ''\n            }`}\n            onClick={() => handleOptionClick(option)}\n            role=\"option\"\n            aria-selected={isSelected}\n            data-value={option.value}\n          >\n            {option.icon && <span className={styles['option-icon']}>{option.icon}</span>}\n            <span>{option.label}</span>\n          </div>\n        );\n      });\n    };\n\n    // Render dropdown content\n    const renderDropdown = () => {\n      if (groups.length > 0) {\n        return groups.map((group) => (\n          <React.Fragment key={group.label}>\n            <div className={styles['custom-select-group-label']}>{group.label}</div>\n            {renderOptions(group.options)}\n          </React.Fragment>\n        ));\n      }\n      return renderOptions(options);\n    };\n\n    return (\n      <div\n        ref={(node) => {\n          if (typeof ref === 'function') {\n            ref(node);\n          } else if (ref) {\n            ref.current = node;\n          }\n          (containerRef as React.MutableRefObject<HTMLDivElement | null>).current = node;\n        }}\n        className={`${styles['input-group']} ${fullWidth ? styles['input-full-width'] : ''} ${className}`}\n      >\n        {label && (\n          <label htmlFor={selectId} className={styles['input-label']}>\n            {label}\n            {required && <span className={styles.required}>*</span>}\n          </label>\n        )}\n\n        <div\n          className={`${styles['custom-select']} ${\n            isOpen ? styles.open : ''\n          } ${state === 'error' ? styles.error : ''} ${\n            disabled ? styles.disabled : ''\n          } ${styles[`select-${size}`] || ''}`}\n        >\n          {/* Hidden native select for form submission */}\n          <select\n            id={selectId}\n            name={name}\n            value={currentValue}\n            onChange={() => {}}\n            className={styles['native-select']}\n            disabled={disabled}\n            required={required}\n            tabIndex={-1}\n            aria-hidden=\"true\"\n          >\n            <option value=\"\">{placeholder}</option>\n            {allOptions.map((option) => (\n              <option key={option.value} value={option.value}>\n                {option.label}\n              </option>\n            ))}\n          </select>\n\n          {/* Custom trigger */}\n          <div\n            ref={triggerRef}\n            className={`${styles['custom-select-trigger']} ${\n              !selectedOption ? styles.placeholder : ''\n            }`}\n            onClick={toggleDropdown}\n            onKeyDown={handleKeyDown}\n            tabIndex={disabled ? -1 : 0}\n            role=\"combobox\"\n            aria-expanded={isOpen}\n            aria-haspopup=\"listbox\"\n            aria-controls={`${selectId}-listbox`}\n            aria-labelledby={label ? `${selectId}-label` : undefined}\n            aria-disabled={disabled}\n          >\n            <span className={styles['trigger-content']}>\n              {selectedOption?.icon && (\n                <span className={styles['option-icon']}>{selectedOption.icon}</span>\n              )}\n              {selectedOption ? selectedOption.label : placeholder}\n            </span>\n            <ChevronDown className={styles['select-icon']} size={18} />\n          </div>\n\n          {/* Dropdown */}\n          <div\n            ref={dropdownRef}\n            className={styles['custom-select-dropdown']}\n            role=\"listbox\"\n            id={`${selectId}-listbox`}\n            aria-labelledby={label ? `${selectId}-label` : undefined}\n          >\n            {renderDropdown()}\n          </div>\n        </div>\n\n        {/* Helper text or error message */}\n        {state === 'error' && errorMessage && (\n          <span className={`${styles['input-message']} ${styles['input-error']}`}>\n            {errorMessage}\n          </span>\n        )}\n        {state !== 'error' && helperText && (\n          <span className={styles['input-message']}>{helperText}</span>\n        )}\n      </div>\n    );\n  }\n);\n\nSelect.displayName = 'Select';\n"],"names":["Select","React","label","name","controlledValue","defaultValue","placeholder","options","groups","state","size","disabled","helperText","errorMessage","required","fullWidth","onChange","className","id","ref","selectId","isOpen","setIsOpen","useState","selectedValue","setSelectedValue","focusedIndex","setFocusedIndex","containerRef","useRef","dropdownRef","triggerRef","isControlled","currentValue","allOptions","opts","group","opt","selectedOption","handleValueChange","newValue","option","toggleDropdown","prev","handleOptionClick","useEffect","handleClickOutside","event","handleKeyDown","focusedElement","renderOptions","globalIndex","isSelected","isFocused","jsxs","styles","jsx","renderDropdown","node","ChevronDown"],"mappings":"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"}