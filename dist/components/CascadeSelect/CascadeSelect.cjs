"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const i=require("react/jsx-runtime"),f=require("react"),S=require("lucide-react"),c=require("./CascadeSelect.module.css.cjs"),j=({options:h,value:x=[],onChange:w,placeholder:N="Select...",disabled:v=!1,className:R="",...y})=>{const[o,b]=f.useState(!1),[u,M]=f.useState(x),[d,p]=f.useState([]),[P,g]=f.useState(new Map),m=f.useRef(null);f.useEffect(()=>{const t=e=>{m.current&&!m.current.contains(e.target)&&(b(!1),p([]),g(new Map))};return o&&document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[o]);const k=()=>{if(u.length===0)return N;const t=[];let e=h;for(const n of u){const a=e.find(l=>l.value===n);a&&(t.push(a.label),e=a.children||[])}return t.join(" / ")},T=t=>{if(t===0)return h;const e=d.length>=t?d:u;let n=h;for(let a=0;a<t;a++){const l=e[a];if(!l)return[];const r=n.find(s=>s.value===l);if(r?.children)n=r.children;else return[]}return n},E=()=>{let t=1;const e=d.length>0?d:u;let n=h;for(const a of e){const l=n.find(r=>r.value===a);if(l?.children&&l.children.length>0)t++,n=l.children;else break}return t},L=(t,e,n)=>{if(t.disabled)return;const a=[...d.slice(0,e),t.value];p(a),n&&g(l=>{const r=new Map(l);return r.set(e,n),r})},q=(t,e)=>{if(t.disabled)return;const n=[...d.slice(0,e),t.value];if(!t.children||t.children.length===0){M(n),b(!1),p([]),g(new Map);const a=[];let l=h;for(const r of n){const s=l.find(C=>C.value===r);s&&(a.push(s.label),l=s.children||[])}w?.(n,a)}else p(n)},O=(t,e)=>u[e]===t,B=(t,e)=>d[e]===t,_=[c.default["cascade-select"],o&&c.default.open,v&&c.default.disabled,R].filter(Boolean).join(" "),H=[c.default["cascade-trigger"],u.length===0&&c.default.placeholder].filter(Boolean).join(" "),z=o?E():0;return i.jsxs("div",{ref:m,className:_,...y,children:[i.jsxs("button",{type:"button",className:H,onClick:()=>!v&&b(!o),disabled:v,"aria-haspopup":"listbox","aria-expanded":o,children:[k(),i.jsx(S.ChevronDown,{className:c.default["select-icon"],size:18})]}),o&&i.jsx("div",{className:c.default["cascade-panel"],children:Array.from({length:z}).map((t,e)=>{const n=T(e);if(n.length===0)return null;const a=[c.default["cascade-subpanel"],e>0&&c.default.nested,e>0&&c.default.show].filter(Boolean).join(" ");let l=0;if(e>0){const s=P.get(e-1);s&&(l=s.offsetTop)}const r=e>0?{position:"absolute",left:`${e*100}%`,top:l}:{};return i.jsx("div",{className:a,style:r,children:n.map(s=>{const C=s.children&&s.children.length>0,A=[c.default["cascade-option"],O(s.value,e)&&c.default.selected,B(s.value,e)&&c.default.active,s.disabled&&c.default.disabled].filter(Boolean).join(" ");return i.jsxs("div",{className:A,onClick:()=>q(s,e),onMouseEnter:D=>L(s,e,D.currentTarget),role:"option","aria-selected":O(s.value,e),"aria-disabled":s.disabled,children:[i.jsx("span",{children:s.label}),C&&i.jsx(S.ChevronRight,{className:c.default["option-arrow"],size:16})]},s.value)})},e)})})]})};j.displayName="CascadeSelect";exports.CascadeSelect=j;exports.default=j;
//# sourceMappingURL=CascadeSelect.cjs.map
