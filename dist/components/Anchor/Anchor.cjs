"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const u=require("react/jsx-runtime"),a=require("react"),o=require("./Anchor.module.css.cjs"),A=({items:p,activeKey:i,offsetTop:b=60,sticky:x=!1,onChange:f,className:R="",rootMargin:k="-20% 0px -80% 0px",smooth:g=!0})=>{const[S,y]=a.useState(""),j=a.useRef(null),v=a.useRef(new Map),l=a.useRef(null),D=i!==void 0?i:S,w=a.useCallback(e=>e.reduce((r,t)=>(r.push(t),t.children&&r.push(...w(t.children)),r),[]),[]),h=w(p);a.useEffect(()=>{if(h.length===0)return;const e=[];if(h.forEach(n=>{const s=n.href.substring(1),c=document.getElementById(s);c&&e.push(c)}),e.length===0)return;const r={rootMargin:k,threshold:[0,.25,.5,.75,1]},t=new Set;return l.current=new IntersectionObserver(n=>{if(n.forEach(s=>{s.isIntersecting?t.add(s.target.id):t.delete(s.target.id)}),t.size>0){const s=e.find(c=>t.has(c.id));if(s){const c=h.find(d=>d.href==="#"+s.id);if(c){const d=c.key;i===void 0&&y(d),f?.(d)}}}},r),e.forEach(n=>{l.current?.observe(n)}),()=>{l.current&&(e.forEach(n=>{l.current?.unobserve(n)}),l.current.disconnect())}},[h,k,f,i]);const E=a.useCallback((e,r)=>{e.preventDefault();const t=r.href.substring(1),n=document.getElementById(t);if(n){const s=-b,c=n.getBoundingClientRect().top+window.pageYOffset+s;window.scrollTo({top:c,behavior:g?"smooth":"auto"}),history.pushState&&history.pushState(null,"",r.href),i===void 0&&y(r.key),f?.(r.key)}},[b,g,i,f]),m=a.useCallback((e,r)=>{const t=Array.from(v.current.values());let n;switch(e.key){case"ArrowDown":e.preventDefault(),n=Math.min(r+1,t.length-1),t[n]?.focus();break;case"ArrowUp":e.preventDefault(),n=Math.max(r-1,0),t[n]?.focus();break;case"Home":e.preventDefault(),t[0]?.focus();break;case"End":e.preventDefault(),t[t.length-1]?.focus();break}},[]),I=(e,r)=>{const t=D===e.key;return u.jsxs("div",{className:o.default.anchorItem,children:[u.jsxs("a",{href:e.href,ref:n=>{n?v.current.set(e.key,n):v.current.delete(e.key)},className:`${o.default.anchorLink} ${t?o.default.active:""}`,onClick:n=>E(n,e),onKeyDown:n=>m(n,r),"aria-current":t?"location":void 0,children:[e.icon&&u.jsx("span",{className:o.default.anchorIcon,children:e.icon}),u.jsx("span",{children:e.title})]}),e.children&&e.children.length>0&&u.jsx("div",{className:o.default.anchorSubmenu,children:e.children.map((n,s)=>I(n,r+s+1))})]},e.key)};return u.jsx("nav",{ref:j,className:`${o.default.anchor} ${x?o.default.sticky:""} ${R}`,role:"navigation","aria-label":"Page navigation",children:p.map((e,r)=>I(e,r))})};exports.Anchor=A;
//# sourceMappingURL=Anchor.cjs.map
