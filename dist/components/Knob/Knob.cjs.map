{"version":3,"file":"Knob.cjs","sources":["../../../src/components/Knob/Knob.tsx"],"sourcesContent":["import { useState, useRef, useEffect, useCallback } from 'react';\nimport styles from './Knob.module.css';\n\nexport type KnobSize = 'sm' | 'md' | 'lg';\nexport type KnobVariant = 'primary' | 'success' | 'warning' | 'error';\n\nexport interface KnobProps {\n  /** Current value */\n  value?: number;\n  /** Default value (uncontrolled) */\n  defaultValue?: number;\n  /** Minimum value */\n  min?: number;\n  /** Maximum value */\n  max?: number;\n  /** Step increment */\n  step?: number;\n  /** Value label (e.g., \"°C\", \"%\") */\n  label?: string;\n  /** Show min/max labels */\n  showLabels?: boolean;\n  /** Show position indicator/marker */\n  showIndicator?: boolean;\n  /** Size variant */\n  size?: KnobSize;\n  /** Color variant */\n  variant?: KnobVariant;\n  /** Disabled state */\n  disabled?: boolean;\n  /** Read only state */\n  readOnly?: boolean;\n  /** Callback when value changes */\n  onChange?: (value: number) => void;\n  /** Additional CSS classes */\n  className?: string;\n}\n\n/**\n * Knob - Circular dial input for adjusting values\n *\n * Features:\n * - Drag to adjust value\n * - Multiple sizes and colors\n * - Min/max range\n * - Step increments\n * - Label support\n *\n * @example\n * ```tsx\n * <Knob\n *   value={temperature}\n *   onChange={setTemperature}\n *   min={15}\n *   max={30}\n *   label=\"°C\"\n * />\n * ```\n */\nexport const Knob = ({\n  value: controlledValue,\n  defaultValue = 0,\n  min = 0,\n  max = 100,\n  step = 1,\n  label,\n  showLabels = false,\n  showIndicator = true,\n  size = 'md',\n  variant = 'primary',\n  disabled = false,\n  readOnly = false,\n  onChange,\n  className = '',\n}: KnobProps) => {\n  const [uncontrolledValue, setUncontrolledValue] = useState(defaultValue);\n  const [isDragging, setIsDragging] = useState(false);\n  const knobRef = useRef<HTMLDivElement>(null);\n  const startAngleRef = useRef(0);\n  const startValueRef = useRef(0);\n\n  const value = controlledValue !== undefined ? controlledValue : uncontrolledValue;\n\n  // Clamp value\n  const clampValue = useCallback((val: number): number => {\n    return Math.max(min, Math.min(max, val));\n  }, [min, max]);\n\n  // Round to step\n  const roundToStep = useCallback((val: number): number => {\n    return Math.round(val / step) * step;\n  }, [step]);\n\n  // Format value for display\n  const formatValue = useCallback((val: number): string => {\n    // Determine decimal places from step\n    const decimals = step.toString().includes('.')\n      ? step.toString().split('.')[1].length\n      : 0;\n    return val.toFixed(decimals);\n  }, [step]);\n\n  // Handle value change\n  const handleChange = useCallback((newValue: number) => {\n    const clamped = clampValue(roundToStep(newValue));\n    if (controlledValue === undefined) {\n      setUncontrolledValue(clamped);\n    }\n    onChange?.(clamped);\n  }, [clampValue, roundToStep, controlledValue, onChange]);\n\n  // Calculate angle from mouse position\n  const calculateAngle = (clientX: number, clientY: number): number => {\n    if (!knobRef.current) return 0;\n\n    const rect = knobRef.current.getBoundingClientRect();\n    const centerX = rect.left + rect.width / 2;\n    const centerY = rect.top + rect.height / 2;\n\n    const dx = clientX - centerX;\n    const dy = clientY - centerY;\n\n    let angle = Math.atan2(dy, dx) * (180 / Math.PI);\n    angle = (angle + 360) % 360;\n\n    return angle;\n  };\n\n  // Mouse down handler\n  const handleMouseDown = (e: React.MouseEvent) => {\n    if (disabled || readOnly) return;\n    e.preventDefault();\n\n    setIsDragging(true);\n    startAngleRef.current = calculateAngle(e.clientX, e.clientY);\n    startValueRef.current = value;\n  };\n\n  // Touch start handler\n  const handleTouchStart = (e: React.TouchEvent) => {\n    if (disabled || readOnly) return;\n    e.preventDefault();\n\n    const touch = e.touches[0];\n    setIsDragging(true);\n    startAngleRef.current = calculateAngle(touch.clientX, touch.clientY);\n    startValueRef.current = value;\n  };\n\n  // Keyboard handler\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (disabled || readOnly) return;\n\n    const valueRange = max - min;\n    const pageStep = valueRange * 0.1; // 10% of range\n\n    let newValue = value;\n\n    switch (e.key) {\n      case 'ArrowUp':\n      case 'ArrowRight':\n        e.preventDefault();\n        newValue = value + step;\n        break;\n      case 'ArrowDown':\n      case 'ArrowLeft':\n        e.preventDefault();\n        newValue = value - step;\n        break;\n      case 'PageUp':\n        e.preventDefault();\n        newValue = value + pageStep;\n        break;\n      case 'PageDown':\n        e.preventDefault();\n        newValue = value - pageStep;\n        break;\n      case 'Home':\n        e.preventDefault();\n        newValue = min;\n        break;\n      case 'End':\n        e.preventDefault();\n        newValue = max;\n        break;\n      default:\n        return;\n    }\n\n    handleChange(newValue);\n  };\n\n  // Handle drag\n  useEffect(() => {\n    if (!isDragging) return;\n\n    const handleMove = (clientX: number, clientY: number) => {\n      const currentAngle = calculateAngle(clientX, clientY);\n      let angleDiff = currentAngle - startAngleRef.current;\n\n      // Handle wrapping\n      if (angleDiff > 180) angleDiff -= 360;\n      if (angleDiff < -180) angleDiff += 360;\n\n      const valueRange = max - min;\n      const valueChange = (angleDiff / 360) * valueRange;\n      const newValue = startValueRef.current + valueChange;\n\n      handleChange(newValue);\n    };\n\n    const handleMouseMove = (e: MouseEvent) => {\n      handleMove(e.clientX, e.clientY);\n    };\n\n    const handleTouchMove = (e: TouchEvent) => {\n      e.preventDefault();\n      const touch = e.touches[0];\n      handleMove(touch.clientX, touch.clientY);\n    };\n\n    const handleEnd = () => {\n      setIsDragging(false);\n    };\n\n    document.addEventListener('mousemove', handleMouseMove);\n    document.addEventListener('mouseup', handleEnd);\n    document.addEventListener('touchmove', handleTouchMove, { passive: false });\n    document.addEventListener('touchend', handleEnd);\n\n    return () => {\n      document.removeEventListener('mousemove', handleMouseMove);\n      document.removeEventListener('mouseup', handleEnd);\n      document.removeEventListener('touchmove', handleTouchMove);\n      document.removeEventListener('touchend', handleEnd);\n    };\n  }, [isDragging, max, min, handleChange]);\n\n  // Calculate SVG properties\n  const radius = 85;\n  const circumference = 2 * Math.PI * radius;\n  const percentage = (value - min) / (max - min);\n\n  // Configuration (matching original)\n  const startAngle = 135; // 7:30 position\n  const angleRange = 270; // 270 degrees rotation\n\n  // Calculate angle in degrees\n  const angleDeg = startAngle + (percentage * angleRange);\n\n  // Calculate progress arc\n  const maxArcLength = (angleRange / 360) * circumference;\n  const currentArcLength = maxArcLength * percentage;\n  const strokeDashoffset = circumference - currentArcLength;\n\n  // Calculate handle position using trigonometry (not transform)\n  const angleRad = (angleDeg * Math.PI) / 180;\n  const handleX = 100 + radius * Math.cos(angleRad);\n  const handleY = 100 + radius * Math.sin(angleRad);\n\n  const knobClasses = [\n    styles.knob,\n    size === 'sm' && styles['knob--sm'],\n    size === 'lg' && styles['knob--lg'],\n    styles[`knob--${variant}`],\n    disabled && styles['knob--disabled'],\n    readOnly && styles['knob--readonly'],\n    isDragging && styles['knob-dragging'],\n    className,\n  ]\n    .filter(Boolean)\n    .join(' ');\n\n  return (\n    <div\n      ref={knobRef}\n      className={knobClasses}\n      onMouseDown={handleMouseDown}\n      onTouchStart={handleTouchStart}\n      onKeyDown={handleKeyDown}\n      role=\"slider\"\n      aria-valuenow={value}\n      aria-valuemin={min}\n      aria-valuemax={max}\n      aria-disabled={disabled}\n      aria-readonly={readOnly}\n      aria-label={label ? `${label} control` : 'Value control'}\n      tabIndex={disabled || readOnly ? -1 : 0}\n    >\n      <svg className={styles['knob-svg']} viewBox=\"0 0 200 200\">\n        {/* Track */}\n        <circle\n          className={styles['knob-track']}\n          cx=\"100\"\n          cy=\"100\"\n          r={radius}\n          fill=\"none\"\n          strokeWidth=\"12\"\n        />\n\n        {/* Progress */}\n        <circle\n          className={styles['knob-progress']}\n          cx=\"100\"\n          cy=\"100\"\n          r={radius}\n          fill=\"none\"\n          strokeWidth=\"12\"\n          strokeLinecap=\"round\"\n          strokeDasharray={`${circumference} ${circumference}`}\n          strokeDashoffset={strokeDashoffset}\n          style={{\n            transformOrigin: 'center',\n            transform: `rotate(${startAngle}deg)`\n          }}\n        />\n\n        {/* Handle (draggable pointer) */}\n        {showIndicator && (\n          <circle\n            className={styles['knob-handle']}\n            cx={handleX}\n            cy={handleY}\n            r=\"8\"\n          />\n        )}\n\n        {/* Value */}\n        <text\n          className={styles['knob-value']}\n          x=\"100\"\n          y={label ? \"95\" : \"100\"}\n          textAnchor=\"middle\"\n          dominantBaseline=\"middle\"\n        >\n          {formatValue(value)}\n        </text>\n\n        {/* Label */}\n        {label && (\n          <text\n            className={styles['knob-label']}\n            x=\"100\"\n            y=\"120\"\n            textAnchor=\"middle\"\n            dominantBaseline=\"middle\"\n          >\n            {label}\n          </text>\n        )}\n\n        {/* Min/Max Labels */}\n        {showLabels && (\n          <>\n            <text\n              className={styles['knob-min-label']}\n              x=\"30\"\n              y=\"175\"\n              textAnchor=\"middle\"\n            >\n              {min}\n            </text>\n            <text\n              className={styles['knob-max-label']}\n              x=\"170\"\n              y=\"175\"\n              textAnchor=\"middle\"\n            >\n              {max}\n            </text>\n          </>\n        )}\n      </svg>\n    </div>\n  );\n};\n"],"names":["Knob","controlledValue","defaultValue","min","max","step","label","showLabels","showIndicator","size","variant","disabled","readOnly","onChange","className","uncontrolledValue","setUncontrolledValue","useState","isDragging","setIsDragging","knobRef","useRef","startAngleRef","startValueRef","value","clampValue","useCallback","val","roundToStep","formatValue","decimals","handleChange","newValue","clamped","calculateAngle","clientX","clientY","rect","centerX","centerY","dx","dy","angle","handleMouseDown","handleTouchStart","touch","handleKeyDown","pageStep","useEffect","handleMove","angleDiff","valueRange","valueChange","handleMouseMove","e","handleTouchMove","handleEnd","radius","circumference","percentage","startAngle","angleRange","angleDeg","currentArcLength","strokeDashoffset","angleRad","handleX","handleY","knobClasses","styles","jsx","jsxs","Fragment"],"mappings":"2KA0DaA,GAAO,CAAC,CACnB,MAAOC,EACP,aAAAC,EAAe,EACf,IAAAC,EAAM,EACN,IAAAC,EAAM,IACN,KAAAC,EAAO,EACP,MAAAC,EACA,WAAAC,EAAa,GACb,cAAAC,EAAgB,GAChB,KAAAC,EAAO,KACP,QAAAC,EAAU,UACV,SAAAC,EAAW,GACX,SAAAC,EAAW,GACX,SAAAC,EACA,UAAAC,EAAY,EACd,IAAiB,CACf,KAAM,CAACC,EAAmBC,CAAoB,EAAIC,EAAAA,SAASf,CAAY,EACjE,CAACgB,EAAYC,CAAa,EAAIF,EAAAA,SAAS,EAAK,EAC5CG,EAAUC,EAAAA,OAAuB,IAAI,EACrCC,EAAgBD,EAAAA,OAAO,CAAC,EACxBE,EAAgBF,EAAAA,OAAO,CAAC,EAExBG,EAAQvB,IAAoB,OAAYA,EAAkBc,EAG1DU,EAAaC,cAAaC,GACvB,KAAK,IAAIxB,EAAK,KAAK,IAAIC,EAAKuB,CAAG,CAAC,EACtC,CAACxB,EAAKC,CAAG,CAAC,EAGPwB,EAAcF,cAAaC,GACxB,KAAK,MAAMA,EAAMtB,CAAI,EAAIA,EAC/B,CAACA,CAAI,CAAC,EAGHwB,EAAcH,cAAaC,GAAwB,CAEvD,MAAMG,EAAWzB,EAAK,SAAA,EAAW,SAAS,GAAG,EACzCA,EAAK,SAAA,EAAW,MAAM,GAAG,EAAE,CAAC,EAAE,OAC9B,EACJ,OAAOsB,EAAI,QAAQG,CAAQ,CAC7B,EAAG,CAACzB,CAAI,CAAC,EAGH0B,EAAeL,cAAaM,GAAqB,CACrD,MAAMC,EAAUR,EAAWG,EAAYI,CAAQ,CAAC,EAC5C/B,IAAoB,QACtBe,EAAqBiB,CAAO,EAE9BpB,IAAWoB,CAAO,CACpB,EAAG,CAACR,EAAYG,EAAa3B,EAAiBY,CAAQ,CAAC,EAGjDqB,EAAiB,CAACC,EAAiBC,IAA4B,CACnE,GAAI,CAAChB,EAAQ,QAAS,MAAO,GAE7B,MAAMiB,EAAOjB,EAAQ,QAAQ,sBAAA,EACvBkB,EAAUD,EAAK,KAAOA,EAAK,MAAQ,EACnCE,EAAUF,EAAK,IAAMA,EAAK,OAAS,EAEnCG,EAAKL,EAAUG,EACfG,EAAKL,EAAUG,EAErB,IAAIG,EAAQ,KAAK,MAAMD,EAAID,CAAE,GAAK,IAAM,KAAK,IAC7C,OAAAE,GAASA,EAAQ,KAAO,IAEjBA,CACT,EAGMC,EAAmB,GAAwB,CAC3ChC,GAAYC,IAChB,EAAE,eAAA,EAEFO,EAAc,EAAI,EAClBG,EAAc,QAAUY,EAAe,EAAE,QAAS,EAAE,OAAO,EAC3DX,EAAc,QAAUC,EAC1B,EAGMoB,EAAoB,GAAwB,CAChD,GAAIjC,GAAYC,EAAU,OAC1B,EAAE,eAAA,EAEF,MAAMiC,EAAQ,EAAE,QAAQ,CAAC,EACzB1B,EAAc,EAAI,EAClBG,EAAc,QAAUY,EAAeW,EAAM,QAASA,EAAM,OAAO,EACnEtB,EAAc,QAAUC,CAC1B,EAGMsB,EAAiB,GAA2B,CAChD,GAAInC,GAAYC,EAAU,OAG1B,MAAMmC,GADa3C,EAAMD,GACK,GAE9B,IAAI6B,EAAWR,EAEf,OAAQ,EAAE,IAAA,CACR,IAAK,UACL,IAAK,aACH,EAAE,eAAA,EACFQ,EAAWR,EAAQnB,EACnB,MACF,IAAK,YACL,IAAK,YACH,EAAE,eAAA,EACF2B,EAAWR,EAAQnB,EACnB,MACF,IAAK,SACH,EAAE,eAAA,EACF2B,EAAWR,EAAQuB,EACnB,MACF,IAAK,WACH,EAAE,eAAA,EACFf,EAAWR,EAAQuB,EACnB,MACF,IAAK,OACH,EAAE,eAAA,EACFf,EAAW7B,EACX,MACF,IAAK,MACH,EAAE,eAAA,EACF6B,EAAW5B,EACX,MACF,QACE,MAAA,CAGJ2B,EAAaC,CAAQ,CACvB,EAGAgB,EAAAA,UAAU,IAAM,CACd,GAAI,CAAC9B,EAAY,OAEjB,MAAM+B,EAAa,CAACd,EAAiBC,IAAoB,CAEvD,IAAIc,EADiBhB,EAAeC,EAASC,CAAO,EACrBd,EAAc,QAGzC4B,EAAY,MAAKA,GAAa,KAC9BA,EAAY,OAAMA,GAAa,KAEnC,MAAMC,EAAa/C,EAAMD,EACnBiD,GAAeF,EAAY,IAAOC,EAClCnB,GAAWT,EAAc,QAAU6B,GAEzCrB,EAAaC,EAAQ,CACvB,EAEMqB,EAAmBC,GAAkB,CACzCL,EAAWK,EAAE,QAASA,EAAE,OAAO,CACjC,EAEMC,EAAmBD,GAAkB,CACzCA,EAAE,eAAA,EACF,MAAMT,EAAQS,EAAE,QAAQ,CAAC,EACzBL,EAAWJ,EAAM,QAASA,EAAM,OAAO,CACzC,EAEMW,EAAY,IAAM,CACtBrC,EAAc,EAAK,CACrB,EAEA,gBAAS,iBAAiB,YAAakC,CAAe,EACtD,SAAS,iBAAiB,UAAWG,CAAS,EAC9C,SAAS,iBAAiB,YAAaD,EAAiB,CAAE,QAAS,GAAO,EAC1E,SAAS,iBAAiB,WAAYC,CAAS,EAExC,IAAM,CACX,SAAS,oBAAoB,YAAaH,CAAe,EACzD,SAAS,oBAAoB,UAAWG,CAAS,EACjD,SAAS,oBAAoB,YAAaD,CAAe,EACzD,SAAS,oBAAoB,WAAYC,CAAS,CACpD,CACF,EAAG,CAACtC,EAAYd,EAAKD,EAAK4B,CAAY,CAAC,EAGvC,MAAM0B,EAAS,GACTC,EAAgB,EAAI,KAAK,GAAKD,EAC9BE,GAAcnC,EAAQrB,IAAQC,EAAMD,GAGpCyD,EAAa,IACbC,EAAa,IAGbC,EAAWF,EAAcD,EAAaE,EAItCE,EADgBF,EAAa,IAAOH,EACFC,EAClCK,EAAmBN,EAAgBK,EAGnCE,EAAYH,EAAW,KAAK,GAAM,IAClCI,EAAU,IAAMT,EAAS,KAAK,IAAIQ,CAAQ,EAC1CE,EAAU,IAAMV,EAAS,KAAK,IAAIQ,CAAQ,EAE1CG,EAAc,CAClBC,EAAAA,QAAO,KACP5D,IAAS,MAAQ4D,EAAAA,QAAO,UAAU,EAClC5D,IAAS,MAAQ4D,EAAAA,QAAO,UAAU,EAClCA,EAAAA,QAAO,SAAS3D,CAAO,EAAE,EACzBC,GAAY0D,EAAAA,QAAO,gBAAgB,EACnCzD,GAAYyD,EAAAA,QAAO,gBAAgB,EACnCnD,GAAcmD,EAAAA,QAAO,eAAe,EACpCvD,CAAA,EAEC,OAAO,OAAO,EACd,KAAK,GAAG,EAEX,OACEwD,EAAAA,IAAC,MAAA,CACC,IAAKlD,EACL,UAAWgD,EACX,YAAazB,EACb,aAAcC,EACd,UAAWE,EACX,KAAK,SACL,gBAAetB,EACf,gBAAerB,EACf,gBAAeC,EACf,gBAAeO,EACf,gBAAeC,EACf,aAAYN,EAAQ,GAAGA,CAAK,WAAa,gBACzC,SAAUK,GAAYC,EAAW,GAAK,EAEtC,gBAAC,MAAA,CAAI,UAAWyD,UAAO,UAAU,EAAG,QAAQ,cAE1C,SAAA,CAAAC,EAAAA,IAAC,SAAA,CACC,UAAWD,EAAAA,QAAO,YAAY,EAC9B,GAAG,MACH,GAAG,MACH,EAAGZ,EACH,KAAK,OACL,YAAY,IAAA,CAAA,EAIda,EAAAA,IAAC,SAAA,CACC,UAAWD,EAAAA,QAAO,eAAe,EACjC,GAAG,MACH,GAAG,MACH,EAAGZ,EACH,KAAK,OACL,YAAY,KACZ,cAAc,QACd,gBAAiB,GAAGC,CAAa,IAAIA,CAAa,GAClD,iBAAAM,EACA,MAAO,CACL,gBAAiB,SACjB,UAAW,UAAUJ,CAAU,MAAA,CACjC,CAAA,EAIDpD,GACC8D,EAAAA,IAAC,SAAA,CACC,UAAWD,EAAAA,QAAO,aAAa,EAC/B,GAAIH,EACJ,GAAIC,EACJ,EAAE,GAAA,CAAA,EAKNG,EAAAA,IAAC,OAAA,CACC,UAAWD,EAAAA,QAAO,YAAY,EAC9B,EAAE,MACF,EAAG/D,EAAQ,KAAO,MAClB,WAAW,SACX,iBAAiB,SAEhB,WAAYkB,CAAK,CAAA,CAAA,EAInBlB,GACCgE,EAAAA,IAAC,OAAA,CACC,UAAWD,EAAAA,QAAO,YAAY,EAC9B,EAAE,MACF,EAAE,MACF,WAAW,SACX,iBAAiB,SAEhB,SAAA/D,CAAA,CAAA,EAKJC,GACCgE,EAAAA,KAAAC,WAAA,CACE,SAAA,CAAAF,EAAAA,IAAC,OAAA,CACC,UAAWD,EAAAA,QAAO,gBAAgB,EAClC,EAAE,KACF,EAAE,MACF,WAAW,SAEV,SAAAlE,CAAA,CAAA,EAEHmE,EAAAA,IAAC,OAAA,CACC,UAAWD,EAAAA,QAAO,gBAAgB,EAClC,EAAE,MACF,EAAE,MACF,WAAW,SAEV,SAAAjE,CAAA,CAAA,CACH,CAAA,CACF,CAAA,CAAA,CAEJ,CAAA,CAAA,CAGN"}