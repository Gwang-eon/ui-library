{"version":3,"file":"Knob.js","sources":["../../../src/components/Knob/Knob.tsx"],"sourcesContent":["import { useState, useRef, useEffect, useCallback } from 'react';\nimport styles from './Knob.module.css';\n\nexport type KnobSize = 'sm' | 'md' | 'lg';\nexport type KnobVariant = 'primary' | 'success' | 'warning' | 'error';\n\nexport interface KnobProps {\n  /** Current value */\n  value?: number;\n  /** Default value (uncontrolled) */\n  defaultValue?: number;\n  /** Minimum value */\n  min?: number;\n  /** Maximum value */\n  max?: number;\n  /** Step increment */\n  step?: number;\n  /** Value label (e.g., \"°C\", \"%\") */\n  label?: string;\n  /** Show min/max labels */\n  showLabels?: boolean;\n  /** Show position indicator/marker */\n  showIndicator?: boolean;\n  /** Size variant */\n  size?: KnobSize;\n  /** Color variant */\n  variant?: KnobVariant;\n  /** Disabled state */\n  disabled?: boolean;\n  /** Read only state */\n  readOnly?: boolean;\n  /** Callback when value changes */\n  onChange?: (value: number) => void;\n  /** Additional CSS classes */\n  className?: string;\n}\n\n/**\n * Knob - Circular dial input for adjusting values\n *\n * Features:\n * - Drag to adjust value\n * - Multiple sizes and colors\n * - Min/max range\n * - Step increments\n * - Label support\n *\n * @example\n * ```tsx\n * <Knob\n *   value={temperature}\n *   onChange={setTemperature}\n *   min={15}\n *   max={30}\n *   label=\"°C\"\n * />\n * ```\n */\nexport const Knob = ({\n  value: controlledValue,\n  defaultValue = 0,\n  min = 0,\n  max = 100,\n  step = 1,\n  label,\n  showLabels = false,\n  showIndicator = true,\n  size = 'md',\n  variant = 'primary',\n  disabled = false,\n  readOnly = false,\n  onChange,\n  className = '',\n}: KnobProps) => {\n  const [uncontrolledValue, setUncontrolledValue] = useState(defaultValue);\n  const [isDragging, setIsDragging] = useState(false);\n  const knobRef = useRef<HTMLDivElement>(null);\n  const startAngleRef = useRef(0);\n  const startValueRef = useRef(0);\n\n  const value = controlledValue !== undefined ? controlledValue : uncontrolledValue;\n\n  // Clamp value\n  const clampValue = useCallback((val: number): number => {\n    return Math.max(min, Math.min(max, val));\n  }, [min, max]);\n\n  // Round to step\n  const roundToStep = useCallback((val: number): number => {\n    return Math.round(val / step) * step;\n  }, [step]);\n\n  // Format value for display\n  const formatValue = useCallback((val: number): string => {\n    // Determine decimal places from step\n    const decimals = step.toString().includes('.')\n      ? step.toString().split('.')[1].length\n      : 0;\n    return val.toFixed(decimals);\n  }, [step]);\n\n  // Handle value change\n  const handleChange = useCallback((newValue: number) => {\n    const clamped = clampValue(roundToStep(newValue));\n    if (controlledValue === undefined) {\n      setUncontrolledValue(clamped);\n    }\n    onChange?.(clamped);\n  }, [clampValue, roundToStep, controlledValue, onChange]);\n\n  // Calculate angle from mouse position\n  const calculateAngle = (clientX: number, clientY: number): number => {\n    if (!knobRef.current) return 0;\n\n    const rect = knobRef.current.getBoundingClientRect();\n    const centerX = rect.left + rect.width / 2;\n    const centerY = rect.top + rect.height / 2;\n\n    const dx = clientX - centerX;\n    const dy = clientY - centerY;\n\n    let angle = Math.atan2(dy, dx) * (180 / Math.PI);\n    angle = (angle + 360) % 360;\n\n    return angle;\n  };\n\n  // Mouse down handler\n  const handleMouseDown = (e: React.MouseEvent) => {\n    if (disabled || readOnly) return;\n    e.preventDefault();\n\n    setIsDragging(true);\n    startAngleRef.current = calculateAngle(e.clientX, e.clientY);\n    startValueRef.current = value;\n  };\n\n  // Touch start handler\n  const handleTouchStart = (e: React.TouchEvent) => {\n    if (disabled || readOnly) return;\n    e.preventDefault();\n\n    const touch = e.touches[0];\n    setIsDragging(true);\n    startAngleRef.current = calculateAngle(touch.clientX, touch.clientY);\n    startValueRef.current = value;\n  };\n\n  // Keyboard handler\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (disabled || readOnly) return;\n\n    const valueRange = max - min;\n    const pageStep = valueRange * 0.1; // 10% of range\n\n    let newValue = value;\n\n    switch (e.key) {\n      case 'ArrowUp':\n      case 'ArrowRight':\n        e.preventDefault();\n        newValue = value + step;\n        break;\n      case 'ArrowDown':\n      case 'ArrowLeft':\n        e.preventDefault();\n        newValue = value - step;\n        break;\n      case 'PageUp':\n        e.preventDefault();\n        newValue = value + pageStep;\n        break;\n      case 'PageDown':\n        e.preventDefault();\n        newValue = value - pageStep;\n        break;\n      case 'Home':\n        e.preventDefault();\n        newValue = min;\n        break;\n      case 'End':\n        e.preventDefault();\n        newValue = max;\n        break;\n      default:\n        return;\n    }\n\n    handleChange(newValue);\n  };\n\n  // Handle drag\n  useEffect(() => {\n    if (!isDragging) return;\n\n    const handleMove = (clientX: number, clientY: number) => {\n      const currentAngle = calculateAngle(clientX, clientY);\n      let angleDiff = currentAngle - startAngleRef.current;\n\n      // Handle wrapping\n      if (angleDiff > 180) angleDiff -= 360;\n      if (angleDiff < -180) angleDiff += 360;\n\n      const valueRange = max - min;\n      const valueChange = (angleDiff / 360) * valueRange;\n      const newValue = startValueRef.current + valueChange;\n\n      handleChange(newValue);\n    };\n\n    const handleMouseMove = (e: MouseEvent) => {\n      handleMove(e.clientX, e.clientY);\n    };\n\n    const handleTouchMove = (e: TouchEvent) => {\n      e.preventDefault();\n      const touch = e.touches[0];\n      handleMove(touch.clientX, touch.clientY);\n    };\n\n    const handleEnd = () => {\n      setIsDragging(false);\n    };\n\n    document.addEventListener('mousemove', handleMouseMove);\n    document.addEventListener('mouseup', handleEnd);\n    document.addEventListener('touchmove', handleTouchMove, { passive: false });\n    document.addEventListener('touchend', handleEnd);\n\n    return () => {\n      document.removeEventListener('mousemove', handleMouseMove);\n      document.removeEventListener('mouseup', handleEnd);\n      document.removeEventListener('touchmove', handleTouchMove);\n      document.removeEventListener('touchend', handleEnd);\n    };\n  }, [isDragging, max, min, handleChange]);\n\n  // Calculate SVG properties\n  const radius = 85;\n  const circumference = 2 * Math.PI * radius;\n  const percentage = (value - min) / (max - min);\n\n  // Configuration (matching original)\n  const startAngle = 135; // 7:30 position\n  const angleRange = 270; // 270 degrees rotation\n\n  // Calculate angle in degrees\n  const angleDeg = startAngle + (percentage * angleRange);\n\n  // Calculate progress arc\n  const maxArcLength = (angleRange / 360) * circumference;\n  const currentArcLength = maxArcLength * percentage;\n  const strokeDashoffset = circumference - currentArcLength;\n\n  // Calculate handle position using trigonometry (not transform)\n  const angleRad = (angleDeg * Math.PI) / 180;\n  const handleX = 100 + radius * Math.cos(angleRad);\n  const handleY = 100 + radius * Math.sin(angleRad);\n\n  const knobClasses = [\n    styles.knob,\n    size === 'sm' && styles['knob--sm'],\n    size === 'lg' && styles['knob--lg'],\n    styles[`knob--${variant}`],\n    disabled && styles['knob--disabled'],\n    readOnly && styles['knob--readonly'],\n    isDragging && styles['knob-dragging'],\n    className,\n  ]\n    .filter(Boolean)\n    .join(' ');\n\n  return (\n    <div\n      ref={knobRef}\n      className={knobClasses}\n      onMouseDown={handleMouseDown}\n      onTouchStart={handleTouchStart}\n      onKeyDown={handleKeyDown}\n      role=\"slider\"\n      aria-valuenow={value}\n      aria-valuemin={min}\n      aria-valuemax={max}\n      aria-disabled={disabled}\n      aria-readonly={readOnly}\n      aria-label={label ? `${label} control` : 'Value control'}\n      tabIndex={disabled || readOnly ? -1 : 0}\n    >\n      <svg className={styles['knob-svg']} viewBox=\"0 0 200 200\">\n        {/* Track */}\n        <circle\n          className={styles['knob-track']}\n          cx=\"100\"\n          cy=\"100\"\n          r={radius}\n          fill=\"none\"\n          strokeWidth=\"12\"\n        />\n\n        {/* Progress */}\n        <circle\n          className={styles['knob-progress']}\n          cx=\"100\"\n          cy=\"100\"\n          r={radius}\n          fill=\"none\"\n          strokeWidth=\"12\"\n          strokeLinecap=\"round\"\n          strokeDasharray={`${circumference} ${circumference}`}\n          strokeDashoffset={strokeDashoffset}\n          style={{\n            transformOrigin: 'center',\n            transform: `rotate(${startAngle}deg)`\n          }}\n        />\n\n        {/* Handle (draggable pointer) */}\n        {showIndicator && (\n          <circle\n            className={styles['knob-handle']}\n            cx={handleX}\n            cy={handleY}\n            r=\"8\"\n          />\n        )}\n\n        {/* Value */}\n        <text\n          className={styles['knob-value']}\n          x=\"100\"\n          y={label ? \"95\" : \"100\"}\n          textAnchor=\"middle\"\n          dominantBaseline=\"middle\"\n        >\n          {formatValue(value)}\n        </text>\n\n        {/* Label */}\n        {label && (\n          <text\n            className={styles['knob-label']}\n            x=\"100\"\n            y=\"120\"\n            textAnchor=\"middle\"\n            dominantBaseline=\"middle\"\n          >\n            {label}\n          </text>\n        )}\n\n        {/* Min/Max Labels */}\n        {showLabels && (\n          <>\n            <text\n              className={styles['knob-min-label']}\n              x=\"30\"\n              y=\"175\"\n              textAnchor=\"middle\"\n            >\n              {min}\n            </text>\n            <text\n              className={styles['knob-max-label']}\n              x=\"170\"\n              y=\"175\"\n              textAnchor=\"middle\"\n            >\n              {max}\n            </text>\n          </>\n        )}\n      </svg>\n    </div>\n  );\n};\n"],"names":["Knob","controlledValue","defaultValue","min","max","step","label","showLabels","showIndicator","size","variant","disabled","readOnly","onChange","className","uncontrolledValue","setUncontrolledValue","useState","isDragging","setIsDragging","knobRef","useRef","startAngleRef","startValueRef","value","clampValue","useCallback","val","roundToStep","formatValue","decimals","handleChange","newValue","clamped","calculateAngle","clientX","clientY","rect","centerX","centerY","dx","dy","angle","handleMouseDown","handleTouchStart","touch","handleKeyDown","pageStep","useEffect","handleMove","angleDiff","valueRange","valueChange","handleMouseMove","e","handleTouchMove","handleEnd","radius","circumference","percentage","startAngle","angleRange","angleDeg","currentArcLength","strokeDashoffset","angleRad","handleX","handleY","knobClasses","styles","jsx","jsxs","Fragment"],"mappings":"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"}