{"version":3,"file":"Popconfirm.js","sources":["../../../src/components/Popconfirm/Popconfirm.tsx"],"sourcesContent":["import type { ReactNode, MouseEvent } from 'react';\nimport { useState, useRef, useEffect, cloneElement, isValidElement } from 'react';\nimport { Button } from '../Button';\nimport styles from './Popconfirm.module.css';\n\nexport type PopconfirmPlacement = 'top' | 'bottom' | 'left' | 'right';\nexport type PopconfirmIconType = 'info' | 'success' | 'warning' | 'danger';\n\nexport interface PopconfirmProps {\n  /** Confirmation title */\n  title: ReactNode;\n  /** Confirmation description */\n  description?: ReactNode;\n  /** Icon to display */\n  icon?: ReactNode;\n  /** Icon type for default styling */\n  iconType?: PopconfirmIconType;\n  /** Confirm button text */\n  okText?: ReactNode;\n  /** Cancel button text */\n  cancelText?: ReactNode;\n  /** Confirm button type */\n  okType?: 'primary' | 'success' | 'danger' | 'warning';\n  /** Placement position */\n  placement?: PopconfirmPlacement;\n  /** Trigger element */\n  children: ReactNode;\n  /** Confirm callback */\n  onConfirm?: () => void | Promise<void>;\n  /** Cancel callback */\n  onCancel?: () => void;\n  /** Open state (controlled) */\n  open?: boolean;\n  /** Open state change callback */\n  onOpenChange?: (open: boolean) => void;\n  /** Disabled state */\n  disabled?: boolean;\n  /** ARIA label */\n  'aria-label'?: string;\n}\n\n/**\n * Popconfirm Component\n *\n * Confirmation popup for user actions with confirm/cancel options.\n * Ideal for destructive actions, critical state changes, and preventing accidental clicks.\n *\n * @example\n * ```tsx\n * <Popconfirm\n *   title=\"Are you sure?\"\n *   description=\"This action cannot be undone.\"\n *   onConfirm={() => console.log('Confirmed')}\n * >\n *   <button className=\"btn btn-danger\">Delete</button>\n * </Popconfirm>\n * ```\n *\n * @example\n * ```tsx\n * // With icon and custom buttons\n * <Popconfirm\n *   title=\"Delete device?\"\n *   description=\"This will permanently delete the device.\"\n *   icon={<Trash2 />}\n *   iconType=\"danger\"\n *   okText=\"Delete\"\n *   cancelText=\"Cancel\"\n *   okType=\"danger\"\n *   onConfirm={async () => await deleteDevice()}\n * >\n *   <button className=\"btn btn-danger\">Delete Device</button>\n * </Popconfirm>\n * ```\n */\nexport const Popconfirm = ({\n  title,\n  description,\n  icon,\n  iconType = 'warning',\n  okText = 'OK',\n  cancelText = 'Cancel',\n  okType = 'primary',\n  placement = 'bottom',\n  children,\n  onConfirm,\n  onCancel,\n  open: controlledOpen,\n  onOpenChange,\n  disabled = false,\n  'aria-label': ariaLabel,\n}: PopconfirmProps) => {\n  const [uncontrolledOpen, setUncontrolledOpen] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const previousFocusRef = useRef<HTMLElement | null>(null);\n\n  // Determine if controlled or uncontrolled\n  const isControlled = controlledOpen !== undefined;\n  const isOpen = isControlled ? controlledOpen : uncontrolledOpen;\n\n  const setIsOpen = (open: boolean) => {\n    if (!isControlled) {\n      setUncontrolledOpen(open);\n    }\n    onOpenChange?.(open);\n  };\n\n  // Handle click outside\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleClickOutside = (event: Event) => {\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [isOpen]);\n\n  // Handle Escape key\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleEscape = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        setIsOpen(false);\n        onCancel?.();\n        // Return focus to trigger\n        if (previousFocusRef.current) {\n          previousFocusRef.current.focus();\n        }\n      }\n    };\n\n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [isOpen, onCancel]);\n\n  const handleTriggerClick = (e: MouseEvent) => {\n    if (disabled) return;\n    e.preventDefault();\n    previousFocusRef.current = e.currentTarget as HTMLElement;\n    setIsOpen(!isOpen);\n  };\n\n  const handleCancel = (e: MouseEvent) => {\n    e.stopPropagation();\n    setIsOpen(false);\n    onCancel?.();\n    // Return focus to trigger\n    if (previousFocusRef.current) {\n      previousFocusRef.current.focus();\n    }\n  };\n\n  const handleConfirm = async (e: MouseEvent) => {\n    e.stopPropagation();\n\n    if (onConfirm) {\n      setLoading(true);\n      try {\n        await onConfirm();\n        setIsOpen(false);\n        // Return focus to trigger after action\n        if (previousFocusRef.current) {\n          previousFocusRef.current.focus();\n        }\n      } catch (error) {\n        console.error('Popconfirm onConfirm error:', error);\n      } finally {\n        setLoading(false);\n      }\n    } else {\n      setIsOpen(false);\n    }\n  };\n\n  // Clone trigger element and add onClick\n  const trigger = isValidElement(children)\n    ? cloneElement(children as React.ReactElement<any>, {\n        onClick: (e: MouseEvent) => {\n          handleTriggerClick(e);\n          // Call original onClick if it exists\n          const originalOnClick = (children as any).props?.onClick;\n          if (originalOnClick) {\n            originalOnClick(e);\n          }\n        },\n      })\n    : children;\n\n  const placementClass = {\n    top: styles.popconfirmTop,\n    bottom: '', // default\n    left: styles.popconfirmLeft,\n    right: styles.popconfirmRight,\n  }[placement];\n\n  const iconClass = icon ? '' : styles[`popconfirmIcon${iconType.charAt(0).toUpperCase()}${iconType.slice(1)}`];\n\n  return (\n    <div className={styles.popconfirmContainer} ref={containerRef}>\n      {trigger}\n      <div\n        className={`${styles.popconfirm} ${placementClass} ${isOpen ? styles.popconfirmShow : ''}`}\n        role=\"alertdialog\"\n        aria-modal=\"true\"\n        aria-label={ariaLabel || (typeof title === 'string' ? title : 'Confirm action')}\n      >\n        <div className={styles.popconfirmContent}>\n          <div className={styles.popconfirmMessage}>\n            {icon && <span className={`${styles.popconfirmIcon} ${iconClass}`}>{icon}</span>}\n            <div>\n              <div className={styles.popconfirmTitle}>{title}</div>\n              {description && <div className={styles.popconfirmDescription}>{description}</div>}\n            </div>\n          </div>\n          <div className={styles.popconfirmActions}>\n            <Button\n              variant=\"secondary\"\n              size=\"sm\"\n              onClick={handleCancel}\n              disabled={loading}\n            >\n              {cancelText}\n            </Button>\n            <Button\n              variant={okType}\n              size=\"sm\"\n              onClick={handleConfirm}\n              disabled={loading}\n              loading={loading}\n              autoFocus\n            >\n              {okText}\n            </Button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nPopconfirm.displayName = 'Popconfirm';\n"],"names":["Popconfirm","title","description","icon","iconType","okText","cancelText","okType","placement","children","onConfirm","onCancel","controlledOpen","onOpenChange","disabled","ariaLabel","uncontrolledOpen","setUncontrolledOpen","useState","loading","setLoading","containerRef","useRef","previousFocusRef","isControlled","isOpen","setIsOpen","open","useEffect","handleClickOutside","event","handleEscape","handleTriggerClick","handleCancel","handleConfirm","error","trigger","isValidElement","cloneElement","originalOnClick","placementClass","styles","iconClass","jsx","jsxs","Button"],"mappings":"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"}