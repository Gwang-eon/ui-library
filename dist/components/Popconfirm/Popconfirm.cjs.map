{"version":3,"file":"Popconfirm.cjs","sources":["../../../src/components/Popconfirm/Popconfirm.tsx"],"sourcesContent":["import type { ReactNode, MouseEvent } from 'react';\nimport { useState, useRef, useEffect, cloneElement, isValidElement } from 'react';\nimport { Button } from '../Button';\nimport styles from './Popconfirm.module.css';\n\nexport type PopconfirmPlacement = 'top' | 'bottom' | 'left' | 'right';\nexport type PopconfirmIconType = 'info' | 'success' | 'warning' | 'danger';\n\nexport interface PopconfirmProps {\n  /** Confirmation title */\n  title: ReactNode;\n  /** Confirmation description */\n  description?: ReactNode;\n  /** Icon to display */\n  icon?: ReactNode;\n  /** Icon type for default styling */\n  iconType?: PopconfirmIconType;\n  /** Confirm button text */\n  okText?: ReactNode;\n  /** Cancel button text */\n  cancelText?: ReactNode;\n  /** Confirm button type */\n  okType?: 'primary' | 'success' | 'danger' | 'warning';\n  /** Placement position */\n  placement?: PopconfirmPlacement;\n  /** Trigger element */\n  children: ReactNode;\n  /** Confirm callback */\n  onConfirm?: () => void | Promise<void>;\n  /** Cancel callback */\n  onCancel?: () => void;\n  /** Open state (controlled) */\n  open?: boolean;\n  /** Open state change callback */\n  onOpenChange?: (open: boolean) => void;\n  /** Disabled state */\n  disabled?: boolean;\n  /** ARIA label */\n  'aria-label'?: string;\n}\n\n/**\n * Popconfirm Component\n *\n * Confirmation popup for user actions with confirm/cancel options.\n * Ideal for destructive actions, critical state changes, and preventing accidental clicks.\n *\n * @example\n * ```tsx\n * <Popconfirm\n *   title=\"Are you sure?\"\n *   description=\"This action cannot be undone.\"\n *   onConfirm={() => console.log('Confirmed')}\n * >\n *   <button className=\"btn btn-danger\">Delete</button>\n * </Popconfirm>\n * ```\n *\n * @example\n * ```tsx\n * // With icon and custom buttons\n * <Popconfirm\n *   title=\"Delete device?\"\n *   description=\"This will permanently delete the device.\"\n *   icon={<Trash2 />}\n *   iconType=\"danger\"\n *   okText=\"Delete\"\n *   cancelText=\"Cancel\"\n *   okType=\"danger\"\n *   onConfirm={async () => await deleteDevice()}\n * >\n *   <button className=\"btn btn-danger\">Delete Device</button>\n * </Popconfirm>\n * ```\n */\nexport const Popconfirm = ({\n  title,\n  description,\n  icon,\n  iconType = 'warning',\n  okText = 'OK',\n  cancelText = 'Cancel',\n  okType = 'primary',\n  placement = 'bottom',\n  children,\n  onConfirm,\n  onCancel,\n  open: controlledOpen,\n  onOpenChange,\n  disabled = false,\n  'aria-label': ariaLabel,\n}: PopconfirmProps) => {\n  const [uncontrolledOpen, setUncontrolledOpen] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const previousFocusRef = useRef<HTMLElement | null>(null);\n\n  // Determine if controlled or uncontrolled\n  const isControlled = controlledOpen !== undefined;\n  const isOpen = isControlled ? controlledOpen : uncontrolledOpen;\n\n  const setIsOpen = (open: boolean) => {\n    if (!isControlled) {\n      setUncontrolledOpen(open);\n    }\n    onOpenChange?.(open);\n  };\n\n  // Handle click outside\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleClickOutside = (event: Event) => {\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [isOpen]);\n\n  // Handle Escape key\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const handleEscape = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        setIsOpen(false);\n        onCancel?.();\n        // Return focus to trigger\n        if (previousFocusRef.current) {\n          previousFocusRef.current.focus();\n        }\n      }\n    };\n\n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [isOpen, onCancel]);\n\n  const handleTriggerClick = (e: MouseEvent) => {\n    if (disabled) return;\n    e.preventDefault();\n    previousFocusRef.current = e.currentTarget as HTMLElement;\n    setIsOpen(!isOpen);\n  };\n\n  const handleCancel = (e: MouseEvent) => {\n    e.stopPropagation();\n    setIsOpen(false);\n    onCancel?.();\n    // Return focus to trigger\n    if (previousFocusRef.current) {\n      previousFocusRef.current.focus();\n    }\n  };\n\n  const handleConfirm = async (e: MouseEvent) => {\n    e.stopPropagation();\n\n    if (onConfirm) {\n      setLoading(true);\n      try {\n        await onConfirm();\n        setIsOpen(false);\n        // Return focus to trigger after action\n        if (previousFocusRef.current) {\n          previousFocusRef.current.focus();\n        }\n      } catch (error) {\n        console.error('Popconfirm onConfirm error:', error);\n      } finally {\n        setLoading(false);\n      }\n    } else {\n      setIsOpen(false);\n    }\n  };\n\n  // Clone trigger element and add onClick\n  const trigger = isValidElement(children)\n    ? cloneElement(children as React.ReactElement<any>, {\n        onClick: (e: MouseEvent) => {\n          handleTriggerClick(e);\n          // Call original onClick if it exists\n          const originalOnClick = (children as any).props?.onClick;\n          if (originalOnClick) {\n            originalOnClick(e);\n          }\n        },\n      })\n    : children;\n\n  const placementClass = {\n    top: styles.popconfirmTop,\n    bottom: '', // default\n    left: styles.popconfirmLeft,\n    right: styles.popconfirmRight,\n  }[placement];\n\n  const iconClass = icon ? '' : styles[`popconfirmIcon${iconType.charAt(0).toUpperCase()}${iconType.slice(1)}`];\n\n  return (\n    <div className={styles.popconfirmContainer} ref={containerRef}>\n      {trigger}\n      <div\n        className={`${styles.popconfirm} ${placementClass} ${isOpen ? styles.popconfirmShow : ''}`}\n        role=\"alertdialog\"\n        aria-modal=\"true\"\n        aria-label={ariaLabel || (typeof title === 'string' ? title : 'Confirm action')}\n      >\n        <div className={styles.popconfirmContent}>\n          <div className={styles.popconfirmMessage}>\n            {icon && <span className={`${styles.popconfirmIcon} ${iconClass}`}>{icon}</span>}\n            <div>\n              <div className={styles.popconfirmTitle}>{title}</div>\n              {description && <div className={styles.popconfirmDescription}>{description}</div>}\n            </div>\n          </div>\n          <div className={styles.popconfirmActions}>\n            <Button\n              variant=\"secondary\"\n              size=\"sm\"\n              onClick={handleCancel}\n              disabled={loading}\n            >\n              {cancelText}\n            </Button>\n            <Button\n              variant={okType}\n              size=\"sm\"\n              onClick={handleConfirm}\n              disabled={loading}\n              loading={loading}\n              autoFocus\n            >\n              {okText}\n            </Button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nPopconfirm.displayName = 'Popconfirm';\n"],"names":["Popconfirm","title","description","icon","iconType","okText","cancelText","okType","placement","children","onConfirm","onCancel","controlledOpen","onOpenChange","disabled","ariaLabel","uncontrolledOpen","setUncontrolledOpen","useState","loading","setLoading","containerRef","useRef","previousFocusRef","isControlled","isOpen","setIsOpen","open","useEffect","handleClickOutside","event","handleEscape","handleTriggerClick","handleCancel","handleConfirm","error","trigger","isValidElement","cloneElement","originalOnClick","placementClass","styles","iconClass","jsx","jsxs","Button"],"mappings":"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"}