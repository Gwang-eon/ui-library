{"version":3,"file":"Image.cjs","sources":["../../../src/components/Image/Image.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport type { ImgHTMLAttributes, ReactNode } from 'react';\nimport { createPortal } from 'react-dom';\nimport { Image as ImageIcon, ImageOff, Maximize2, X } from 'lucide-react';\nimport styles from './Image.module.css';\n\nexport interface ImageProps extends Omit<ImgHTMLAttributes<HTMLImageElement>, 'className'> {\n  /** Image source URL */\n  src: string;\n  /** Alt text for accessibility */\n  alt: string;\n  /** Object fit mode */\n  fit?: 'cover' | 'contain' | 'fill' | 'none';\n  /** Border radius variant */\n  radius?: 'default' | 'circle' | 'square';\n  /** Show loading placeholder */\n  placeholder?: boolean | ReactNode;\n  /** Show error fallback */\n  fallback?: ReactNode;\n  /** Enable preview/lightbox on click */\n  preview?: boolean;\n  /** Image caption */\n  caption?: ReactNode;\n  /** Loading state (eager or lazy) */\n  loading?: 'eager' | 'lazy';\n  /** Additional wrapper CSS class */\n  className?: string;\n  /** Width for wrapper */\n  width?: string | number;\n  /** Height for wrapper */\n  height?: string | number;\n}\n\n/**\n * Image Component\n *\n * Enhanced image component with lazy loading, placeholder, error handling, and preview.\n * Optimizes performance and user experience for image-heavy applications.\n *\n * @example\n * ```tsx\n * <Image\n *   src=\"/path/to/image.jpg\"\n *   alt=\"Device photo\"\n *   fit=\"cover\"\n *   preview\n *   caption=\"IoT Gateway Device\"\n * />\n * ```\n */\nexport const Image = ({\n  src,\n  alt,\n  fit = 'none',\n  radius = 'default',\n  placeholder = true,\n  fallback,\n  preview = false,\n  caption,\n  loading = 'lazy',\n  className,\n  width,\n  height,\n  ...rest\n}: ImageProps) => {\n  const [imageStatus, setImageStatus] = useState<'loading' | 'loaded' | 'error'>('loading');\n  const [showLightbox, setShowLightbox] = useState(false);\n\n  const handleLoad = () => {\n    setImageStatus('loaded');\n  };\n\n  const handleError = () => {\n    setImageStatus('error');\n  };\n\n  const handleImageClick = () => {\n    if (preview && imageStatus === 'loaded') {\n      setShowLightbox(true);\n    }\n  };\n\n  const handleCloseLightbox = () => {\n    setShowLightbox(false);\n  };\n\n  // Handle Escape key to close lightbox\n  const handleKeyDown = (e: KeyboardEvent) => {\n    if (e.key === 'Escape') {\n      handleCloseLightbox();\n    }\n  };\n\n  // Add/remove escape listener when lightbox opens/closes\n  useEffect(() => {\n    if (showLightbox) {\n      document.addEventListener('keydown', handleKeyDown);\n      document.body.style.overflow = 'hidden';\n    } else {\n      document.removeEventListener('keydown', handleKeyDown);\n      document.body.style.overflow = '';\n    }\n\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown);\n      document.body.style.overflow = '';\n    };\n  }, [showLightbox]);\n\n  const wrapperClasses = [\n    styles.imageWrapper,\n    radius === 'circle' && styles.imageCircle,\n    radius === 'square' && styles.imageSquare,\n    preview && styles.imagePreview,\n    imageStatus === 'loading' && placeholder && styles.imageLoading,\n    imageStatus === 'error' && styles.imageError,\n    className,\n  ]\n    .filter(Boolean)\n    .join(' ');\n\n  const imgClasses = [\n    styles.image,\n    fit === 'cover' && styles.imageCover,\n    fit === 'contain' && styles.imageContain,\n    fit === 'fill' && styles.imageFill,\n  ]\n    .filter(Boolean)\n    .join(' ');\n\n  const wrapperStyle: React.CSSProperties = {\n    width: width,\n    height: height,\n  };\n\n  const renderContent = () => {\n    // Error state\n    if (imageStatus === 'error') {\n      if (fallback) {\n        return <div className={styles.imageErrorContent}>{fallback}</div>;\n      }\n      return (\n        <div className={styles.imageErrorContent}>\n          <ImageOff />\n          <span>Failed to load image</span>\n        </div>\n      );\n    }\n\n    // Loading state\n    if (imageStatus === 'loading' && placeholder) {\n      if (typeof placeholder === 'boolean') {\n        return (\n          <div className={styles.imagePlaceholder}>\n            <ImageIcon />\n            <span>Loading...</span>\n          </div>\n        );\n      }\n      return <div className={styles.imagePlaceholder}>{placeholder}</div>;\n    }\n\n    // Loaded image\n    return (\n      <>\n        <img\n          className={imgClasses}\n          src={src}\n          alt={alt}\n          loading={loading}\n          onLoad={handleLoad}\n          onError={handleError}\n          style={{\n            display: imageStatus === 'loaded' ? 'block' : 'none',\n          }}\n          {...rest}\n        />\n        {preview && imageStatus === 'loaded' && (\n          <div className={styles.imagePreviewOverlay}>\n            <Maximize2 />\n            <span>Click to preview</span>\n          </div>\n        )}\n      </>\n    );\n  };\n\n  const imageElement = (\n    <div\n      className={wrapperClasses}\n      style={wrapperStyle}\n      onClick={handleImageClick}\n      role={preview ? 'button' : undefined}\n      tabIndex={preview ? 0 : undefined}\n      onKeyDown={\n        preview\n          ? (e) => {\n              if (e.key === 'Enter' || e.key === ' ') {\n                e.preventDefault();\n                handleImageClick();\n              }\n            }\n          : undefined\n      }\n      aria-label={preview ? `Preview ${alt}` : undefined}\n    >\n      {renderContent()}\n    </div>\n  );\n\n  // Lightbox portal\n  const lightbox = showLightbox &&\n    createPortal(\n      <div className={styles.imageLightbox}>\n        <div\n          className={styles.imageLightboxBackdrop}\n          onClick={handleCloseLightbox}\n        />\n        <div className={styles.imageLightboxContent}>\n          <button\n            className={styles.imageLightboxClose}\n            onClick={handleCloseLightbox}\n            aria-label=\"Close preview\"\n            type=\"button\"\n          >\n            <X />\n          </button>\n          <img src={src} alt={alt} />\n        </div>\n      </div>,\n      document.body\n    );\n\n  // With caption\n  if (caption) {\n    return (\n      <>\n        <figure className={styles.imageFigure}>\n          {imageElement}\n          <figcaption className={styles.imageCaption}>{caption}</figcaption>\n        </figure>\n        {lightbox}\n      </>\n    );\n  }\n\n  return (\n    <>\n      {imageElement}\n      {lightbox}\n    </>\n  );\n};\n\nImage.displayName = 'Image';\n"],"names":["Image","src","alt","fit","radius","placeholder","fallback","preview","caption","loading","className","width","height","rest","imageStatus","setImageStatus","useState","showLightbox","setShowLightbox","handleLoad","handleError","handleImageClick","handleCloseLightbox","handleKeyDown","e","useEffect","wrapperClasses","styles","imgClasses","wrapperStyle","renderContent","jsx","jsxs","ImageOff","ImageIcon","Fragment","Maximize2","imageElement","lightbox","createPortal","X"],"mappings":"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"}