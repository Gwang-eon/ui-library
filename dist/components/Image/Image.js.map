{"version":3,"file":"Image.js","sources":["../../../src/components/Image/Image.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport type { ImgHTMLAttributes, ReactNode } from 'react';\nimport { createPortal } from 'react-dom';\nimport { Image as ImageIcon, ImageOff, Maximize2, X } from 'lucide-react';\nimport styles from './Image.module.css';\n\nexport interface ImageProps extends Omit<ImgHTMLAttributes<HTMLImageElement>, 'className'> {\n  /** Image source URL */\n  src: string;\n  /** Alt text for accessibility */\n  alt: string;\n  /** Object fit mode */\n  fit?: 'cover' | 'contain' | 'fill' | 'none';\n  /** Border radius variant */\n  radius?: 'default' | 'circle' | 'square';\n  /** Show loading placeholder */\n  placeholder?: boolean | ReactNode;\n  /** Show error fallback */\n  fallback?: ReactNode;\n  /** Enable preview/lightbox on click */\n  preview?: boolean;\n  /** Image caption */\n  caption?: ReactNode;\n  /** Loading state (eager or lazy) */\n  loading?: 'eager' | 'lazy';\n  /** Additional wrapper CSS class */\n  className?: string;\n  /** Width for wrapper */\n  width?: string | number;\n  /** Height for wrapper */\n  height?: string | number;\n}\n\n/**\n * Image Component\n *\n * Enhanced image component with lazy loading, placeholder, error handling, and preview.\n * Optimizes performance and user experience for image-heavy applications.\n *\n * @example\n * ```tsx\n * <Image\n *   src=\"/path/to/image.jpg\"\n *   alt=\"Device photo\"\n *   fit=\"cover\"\n *   preview\n *   caption=\"IoT Gateway Device\"\n * />\n * ```\n */\nexport const Image = ({\n  src,\n  alt,\n  fit = 'none',\n  radius = 'default',\n  placeholder = true,\n  fallback,\n  preview = false,\n  caption,\n  loading = 'lazy',\n  className,\n  width,\n  height,\n  ...rest\n}: ImageProps) => {\n  const [imageStatus, setImageStatus] = useState<'loading' | 'loaded' | 'error'>('loading');\n  const [showLightbox, setShowLightbox] = useState(false);\n\n  const handleLoad = () => {\n    setImageStatus('loaded');\n  };\n\n  const handleError = () => {\n    setImageStatus('error');\n  };\n\n  const handleImageClick = () => {\n    if (preview && imageStatus === 'loaded') {\n      setShowLightbox(true);\n    }\n  };\n\n  const handleCloseLightbox = () => {\n    setShowLightbox(false);\n  };\n\n  // Handle Escape key to close lightbox\n  const handleKeyDown = (e: KeyboardEvent) => {\n    if (e.key === 'Escape') {\n      handleCloseLightbox();\n    }\n  };\n\n  // Add/remove escape listener when lightbox opens/closes\n  useEffect(() => {\n    if (showLightbox) {\n      document.addEventListener('keydown', handleKeyDown);\n      document.body.style.overflow = 'hidden';\n    } else {\n      document.removeEventListener('keydown', handleKeyDown);\n      document.body.style.overflow = '';\n    }\n\n    return () => {\n      document.removeEventListener('keydown', handleKeyDown);\n      document.body.style.overflow = '';\n    };\n  }, [showLightbox]);\n\n  const wrapperClasses = [\n    styles.imageWrapper,\n    radius === 'circle' && styles.imageCircle,\n    radius === 'square' && styles.imageSquare,\n    preview && styles.imagePreview,\n    imageStatus === 'loading' && placeholder && styles.imageLoading,\n    imageStatus === 'error' && styles.imageError,\n    className,\n  ]\n    .filter(Boolean)\n    .join(' ');\n\n  const imgClasses = [\n    styles.image,\n    fit === 'cover' && styles.imageCover,\n    fit === 'contain' && styles.imageContain,\n    fit === 'fill' && styles.imageFill,\n  ]\n    .filter(Boolean)\n    .join(' ');\n\n  const wrapperStyle: React.CSSProperties = {\n    width: width,\n    height: height,\n  };\n\n  const renderContent = () => {\n    // Error state\n    if (imageStatus === 'error') {\n      if (fallback) {\n        return <div className={styles.imageErrorContent}>{fallback}</div>;\n      }\n      return (\n        <div className={styles.imageErrorContent}>\n          <ImageOff />\n          <span>Failed to load image</span>\n        </div>\n      );\n    }\n\n    // Loading state\n    if (imageStatus === 'loading' && placeholder) {\n      if (typeof placeholder === 'boolean') {\n        return (\n          <div className={styles.imagePlaceholder}>\n            <ImageIcon />\n            <span>Loading...</span>\n          </div>\n        );\n      }\n      return <div className={styles.imagePlaceholder}>{placeholder}</div>;\n    }\n\n    // Loaded image\n    return (\n      <>\n        <img\n          className={imgClasses}\n          src={src}\n          alt={alt}\n          loading={loading}\n          onLoad={handleLoad}\n          onError={handleError}\n          style={{\n            display: imageStatus === 'loaded' ? 'block' : 'none',\n          }}\n          {...rest}\n        />\n        {preview && imageStatus === 'loaded' && (\n          <div className={styles.imagePreviewOverlay}>\n            <Maximize2 />\n            <span>Click to preview</span>\n          </div>\n        )}\n      </>\n    );\n  };\n\n  const imageElement = (\n    <div\n      className={wrapperClasses}\n      style={wrapperStyle}\n      onClick={handleImageClick}\n      role={preview ? 'button' : undefined}\n      tabIndex={preview ? 0 : undefined}\n      onKeyDown={\n        preview\n          ? (e) => {\n              if (e.key === 'Enter' || e.key === ' ') {\n                e.preventDefault();\n                handleImageClick();\n              }\n            }\n          : undefined\n      }\n      aria-label={preview ? `Preview ${alt}` : undefined}\n    >\n      {renderContent()}\n    </div>\n  );\n\n  // Lightbox portal\n  const lightbox = showLightbox &&\n    createPortal(\n      <div className={styles.imageLightbox}>\n        <div\n          className={styles.imageLightboxBackdrop}\n          onClick={handleCloseLightbox}\n        />\n        <div className={styles.imageLightboxContent}>\n          <button\n            className={styles.imageLightboxClose}\n            onClick={handleCloseLightbox}\n            aria-label=\"Close preview\"\n            type=\"button\"\n          >\n            <X />\n          </button>\n          <img src={src} alt={alt} />\n        </div>\n      </div>,\n      document.body\n    );\n\n  // With caption\n  if (caption) {\n    return (\n      <>\n        <figure className={styles.imageFigure}>\n          {imageElement}\n          <figcaption className={styles.imageCaption}>{caption}</figcaption>\n        </figure>\n        {lightbox}\n      </>\n    );\n  }\n\n  return (\n    <>\n      {imageElement}\n      {lightbox}\n    </>\n  );\n};\n\nImage.displayName = 'Image';\n"],"names":["Image","src","alt","fit","radius","placeholder","fallback","preview","caption","loading","className","width","height","rest","imageStatus","setImageStatus","useState","showLightbox","setShowLightbox","handleLoad","handleError","handleImageClick","handleCloseLightbox","handleKeyDown","e","useEffect","wrapperClasses","styles","imgClasses","wrapperStyle","renderContent","jsx","jsxs","ImageOff","ImageIcon","Fragment","Maximize2","imageElement","lightbox","createPortal","X"],"mappings":"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"}