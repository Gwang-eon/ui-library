{"version":3,"file":"Popover.js","sources":["../../../src/components/Popover/Popover.tsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport { createPortal } from 'react-dom';\nimport { X } from 'lucide-react';\nimport styles from './Popover.module.css';\n\nexport interface PopoverProps {\n  open: boolean;\n  onClose: () => void;\n  children: React.ReactNode;\n  position?: 'top' | 'bottom' | 'left' | 'right';\n  wide?: boolean;\n  triggerRef?: React.RefObject<HTMLElement> | React.RefObject<HTMLButtonElement>;\n  className?: string;\n}\n\nexport interface PopoverHeaderProps {\n  children: React.ReactNode;\n  className?: string;\n}\n\nexport interface PopoverContentProps {\n  children: React.ReactNode;\n  className?: string;\n}\n\nexport interface PopoverFooterProps {\n  children: React.ReactNode;\n  className?: string;\n}\n\nexport interface PopoverTitleProps {\n  children: React.ReactNode;\n  className?: string;\n}\n\nexport interface PopoverCloseProps {\n  onClick?: () => void;\n  'aria-label'?: string;\n  className?: string;\n}\n\nconst Popover = ({\n  open,\n  onClose,\n  children,\n  position = 'bottom',\n  wide = false,\n  triggerRef,\n  className = '',\n}: PopoverProps) => {\n  const popoverRef = useRef<HTMLDivElement>(null);\n\n  // Handle click outside\n  useEffect(() => {\n    if (!open) return;\n\n    const handleClickOutside = (event: MouseEvent) => {\n      const target = event.target as Node;\n      const trigger = triggerRef?.current;\n\n      // Don't close if clicking the trigger or the popover itself\n      if (\n        popoverRef.current &&\n        !popoverRef.current.contains(target) &&\n        trigger &&\n        !trigger.contains(target)\n      ) {\n        onClose();\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [open, onClose, triggerRef]);\n\n  // Handle ESC key\n  useEffect(() => {\n    if (!open) return;\n\n    const handleEscape = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        onClose();\n        // Return focus to trigger\n        if (triggerRef?.current) {\n          triggerRef.current.focus();\n        }\n      }\n    };\n\n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [open, onClose, triggerRef]);\n\n  // Position popover relative to trigger\n  useEffect(() => {\n    if (!open || !popoverRef.current || !triggerRef?.current) return;\n\n    const trigger = triggerRef.current;\n    const popover = popoverRef.current;\n    const triggerRect = trigger.getBoundingClientRect();\n    const popoverRect = popover.getBoundingClientRect();\n\n    let top = 0;\n    let left = 0;\n\n    switch (position) {\n      case 'top':\n        top = triggerRect.top - popoverRect.height - 8;\n        left = triggerRect.left + triggerRect.width / 2 - popoverRect.width / 2;\n        break;\n      case 'bottom':\n        top = triggerRect.bottom + 8;\n        left = triggerRect.left + triggerRect.width / 2 - popoverRect.width / 2;\n        break;\n      case 'left':\n        top = triggerRect.top + triggerRect.height / 2 - popoverRect.height / 2;\n        left = triggerRect.left - popoverRect.width - 8;\n        break;\n      case 'right':\n        top = triggerRect.top + triggerRect.height / 2 - popoverRect.height / 2;\n        left = triggerRect.right + 8;\n        break;\n    }\n\n    // Keep within viewport\n    const viewportWidth = window.innerWidth;\n    const viewportHeight = window.innerHeight;\n    const margin = 8;\n\n    if (left < margin) left = margin;\n    if (left + popoverRect.width > viewportWidth - margin) {\n      left = viewportWidth - popoverRect.width - margin;\n    }\n    if (top < margin) top = margin;\n    if (top + popoverRect.height > viewportHeight - margin) {\n      top = viewportHeight - popoverRect.height - margin;\n    }\n\n    popover.style.top = `${top}px`;\n    popover.style.left = `${left}px`;\n  }, [open, position, triggerRef]);\n\n  if (!open) return null;\n\n  const positionClass = position === 'top' ? styles.popoverTop :\n                        position === 'right' ? styles.popoverRight :\n                        position === 'left' ? styles.popoverLeft :\n                        styles.popoverBottom;\n\n  const wideClass = wide ? styles.popoverWide : '';\n\n  return createPortal(\n    <div\n      ref={popoverRef}\n      className={`${styles.popover} ${positionClass} ${wideClass} ${className}`}\n      role=\"dialog\"\n      aria-modal=\"false\"\n    >\n      {children}\n    </div>,\n    document.body\n  );\n};\n\nconst PopoverHeader = ({ children, className = '' }: PopoverHeaderProps) => {\n  return (\n    <div className={`${styles.popoverHeader} ${className}`}>\n      {children}\n    </div>\n  );\n};\n\nconst PopoverContent = ({ children, className = '' }: PopoverContentProps) => {\n  return (\n    <div className={`${styles.popoverContent} ${className}`}>\n      {children}\n    </div>\n  );\n};\n\nconst PopoverFooter = ({ children, className = '' }: PopoverFooterProps) => {\n  return (\n    <div className={`${styles.popoverFooter} ${className}`}>\n      {children}\n    </div>\n  );\n};\n\nconst PopoverTitle = ({ children, className = '' }: PopoverTitleProps) => {\n  return (\n    <span className={`${styles.popoverTitle} ${className}`}>\n      {children}\n    </span>\n  );\n};\n\nconst PopoverClose = ({\n  onClick,\n  'aria-label': ariaLabel = 'Close popover',\n  className = '',\n}: PopoverCloseProps) => {\n  return (\n    <button\n      className={`${styles.popoverClose} ${className}`}\n      onClick={onClick}\n      aria-label={ariaLabel}\n      type=\"button\"\n    >\n      <X size={16} />\n    </button>\n  );\n};\n\nexport {\n  Popover,\n  PopoverHeader,\n  PopoverContent,\n  PopoverFooter,\n  PopoverTitle,\n  PopoverClose,\n};\n"],"names":["Popover","open","onClose","children","position","wide","triggerRef","className","popoverRef","useRef","useEffect","handleClickOutside","event","target","trigger","handleEscape","popover","triggerRect","popoverRect","top","left","viewportWidth","viewportHeight","margin","positionClass","styles","wideClass","createPortal","jsx","PopoverHeader","PopoverContent","PopoverFooter","PopoverTitle","PopoverClose","onClick","ariaLabel","X"],"mappings":"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"}