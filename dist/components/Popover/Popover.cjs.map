{"version":3,"file":"Popover.cjs","sources":["../../../src/components/Popover/Popover.tsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport { createPortal } from 'react-dom';\nimport { X } from 'lucide-react';\nimport styles from './Popover.module.css';\n\nexport interface PopoverProps {\n  open: boolean;\n  onClose: () => void;\n  children: React.ReactNode;\n  position?: 'top' | 'bottom' | 'left' | 'right';\n  wide?: boolean;\n  triggerRef?: React.RefObject<HTMLElement> | React.RefObject<HTMLButtonElement>;\n  className?: string;\n}\n\nexport interface PopoverHeaderProps {\n  children: React.ReactNode;\n  className?: string;\n}\n\nexport interface PopoverContentProps {\n  children: React.ReactNode;\n  className?: string;\n}\n\nexport interface PopoverFooterProps {\n  children: React.ReactNode;\n  className?: string;\n}\n\nexport interface PopoverTitleProps {\n  children: React.ReactNode;\n  className?: string;\n}\n\nexport interface PopoverCloseProps {\n  onClick?: () => void;\n  'aria-label'?: string;\n  className?: string;\n}\n\nconst Popover = ({\n  open,\n  onClose,\n  children,\n  position = 'bottom',\n  wide = false,\n  triggerRef,\n  className = '',\n}: PopoverProps) => {\n  const popoverRef = useRef<HTMLDivElement>(null);\n\n  // Handle click outside\n  useEffect(() => {\n    if (!open) return;\n\n    const handleClickOutside = (event: MouseEvent) => {\n      const target = event.target as Node;\n      const trigger = triggerRef?.current;\n\n      // Don't close if clicking the trigger or the popover itself\n      if (\n        popoverRef.current &&\n        !popoverRef.current.contains(target) &&\n        trigger &&\n        !trigger.contains(target)\n      ) {\n        onClose();\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => document.removeEventListener('mousedown', handleClickOutside);\n  }, [open, onClose, triggerRef]);\n\n  // Handle ESC key\n  useEffect(() => {\n    if (!open) return;\n\n    const handleEscape = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        onClose();\n        // Return focus to trigger\n        if (triggerRef?.current) {\n          triggerRef.current.focus();\n        }\n      }\n    };\n\n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [open, onClose, triggerRef]);\n\n  // Position popover relative to trigger\n  useEffect(() => {\n    if (!open || !popoverRef.current || !triggerRef?.current) return;\n\n    const trigger = triggerRef.current;\n    const popover = popoverRef.current;\n    const triggerRect = trigger.getBoundingClientRect();\n    const popoverRect = popover.getBoundingClientRect();\n\n    let top = 0;\n    let left = 0;\n\n    switch (position) {\n      case 'top':\n        top = triggerRect.top - popoverRect.height - 8;\n        left = triggerRect.left + triggerRect.width / 2 - popoverRect.width / 2;\n        break;\n      case 'bottom':\n        top = triggerRect.bottom + 8;\n        left = triggerRect.left + triggerRect.width / 2 - popoverRect.width / 2;\n        break;\n      case 'left':\n        top = triggerRect.top + triggerRect.height / 2 - popoverRect.height / 2;\n        left = triggerRect.left - popoverRect.width - 8;\n        break;\n      case 'right':\n        top = triggerRect.top + triggerRect.height / 2 - popoverRect.height / 2;\n        left = triggerRect.right + 8;\n        break;\n    }\n\n    // Keep within viewport\n    const viewportWidth = window.innerWidth;\n    const viewportHeight = window.innerHeight;\n    const margin = 8;\n\n    if (left < margin) left = margin;\n    if (left + popoverRect.width > viewportWidth - margin) {\n      left = viewportWidth - popoverRect.width - margin;\n    }\n    if (top < margin) top = margin;\n    if (top + popoverRect.height > viewportHeight - margin) {\n      top = viewportHeight - popoverRect.height - margin;\n    }\n\n    popover.style.top = `${top}px`;\n    popover.style.left = `${left}px`;\n  }, [open, position, triggerRef]);\n\n  if (!open) return null;\n\n  const positionClass = position === 'top' ? styles.popoverTop :\n                        position === 'right' ? styles.popoverRight :\n                        position === 'left' ? styles.popoverLeft :\n                        styles.popoverBottom;\n\n  const wideClass = wide ? styles.popoverWide : '';\n\n  return createPortal(\n    <div\n      ref={popoverRef}\n      className={`${styles.popover} ${positionClass} ${wideClass} ${className}`}\n      role=\"dialog\"\n      aria-modal=\"false\"\n    >\n      {children}\n    </div>,\n    document.body\n  );\n};\n\nconst PopoverHeader = ({ children, className = '' }: PopoverHeaderProps) => {\n  return (\n    <div className={`${styles.popoverHeader} ${className}`}>\n      {children}\n    </div>\n  );\n};\n\nconst PopoverContent = ({ children, className = '' }: PopoverContentProps) => {\n  return (\n    <div className={`${styles.popoverContent} ${className}`}>\n      {children}\n    </div>\n  );\n};\n\nconst PopoverFooter = ({ children, className = '' }: PopoverFooterProps) => {\n  return (\n    <div className={`${styles.popoverFooter} ${className}`}>\n      {children}\n    </div>\n  );\n};\n\nconst PopoverTitle = ({ children, className = '' }: PopoverTitleProps) => {\n  return (\n    <span className={`${styles.popoverTitle} ${className}`}>\n      {children}\n    </span>\n  );\n};\n\nconst PopoverClose = ({\n  onClick,\n  'aria-label': ariaLabel = 'Close popover',\n  className = '',\n}: PopoverCloseProps) => {\n  return (\n    <button\n      className={`${styles.popoverClose} ${className}`}\n      onClick={onClick}\n      aria-label={ariaLabel}\n      type=\"button\"\n    >\n      <X size={16} />\n    </button>\n  );\n};\n\nexport {\n  Popover,\n  PopoverHeader,\n  PopoverContent,\n  PopoverFooter,\n  PopoverTitle,\n  PopoverClose,\n};\n"],"names":["Popover","open","onClose","children","position","wide","triggerRef","className","popoverRef","useRef","useEffect","handleClickOutside","event","target","trigger","handleEscape","popover","triggerRect","popoverRect","top","left","viewportWidth","viewportHeight","margin","positionClass","styles","wideClass","createPortal","jsx","PopoverHeader","PopoverContent","PopoverFooter","PopoverTitle","PopoverClose","onClick","ariaLabel","X"],"mappings":"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"}