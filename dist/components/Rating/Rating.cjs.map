{"version":3,"file":"Rating.cjs","sources":["../../../src/components/Rating/Rating.tsx"],"sourcesContent":["import React, { useState, useCallback, useRef, type KeyboardEvent } from 'react';\nimport { Star, Heart, Circle } from 'lucide-react';\nimport styles from './Rating.module.css';\n\nexport interface RatingProps {\n  /** Current rating value (controlled) */\n  value?: number;\n  /** Default rating value (uncontrolled) */\n  defaultValue?: number;\n  /** Total number of stars */\n  count?: number;\n  /** Size variant */\n  size?: 'sm' | 'md' | 'lg';\n  /** Icon type */\n  icon?: 'star' | 'heart' | 'circle' | React.ReactNode;\n  /** Allow half-star ratings */\n  allowHalf?: boolean;\n  /** Read-only mode (no interaction) */\n  readOnly?: boolean;\n  /** Disabled state */\n  disabled?: boolean;\n  /** Callback when value changes */\n  onChange?: (value: number) => void;\n  /** Show numeric value */\n  showValue?: boolean;\n  /** Show review count */\n  reviewCount?: number;\n  /** Description text */\n  description?: string;\n  /** Label text */\n  label?: string;\n  /** Additional CSS class */\n  className?: string;\n  /** Accessible label for the rating group */\n  ariaLabel?: string;\n}\n\n/**\n * Rating Component\n *\n * Star rating component for user feedback, reviews, and quality assessment.\n * Supports full and half-star ratings, keyboard navigation, and custom icons.\n *\n * @example\n * ```tsx\n * <Rating value={4} onChange={(val) => console.log(val)} />\n * <Rating defaultValue={3.5} allowHalf readOnly reviewCount={128} />\n * <Rating icon=\"heart\" size=\"lg\" />\n * ```\n */\nexport const Rating: React.FC<RatingProps> = ({\n  value: controlledValue,\n  defaultValue = 0,\n  count = 5,\n  size = 'md',\n  icon = 'star',\n  allowHalf = false,\n  readOnly = false,\n  disabled = false,\n  onChange,\n  showValue = false,\n  reviewCount,\n  description,\n  label,\n  className,\n  ariaLabel,\n}) => {\n  const [internalValue, setInternalValue] = useState(defaultValue);\n  const [hoverValue, setHoverValue] = useState<number | null>(null);\n  const [focusedIndex, setFocusedIndex] = useState<number>(-1);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const isControlled = controlledValue !== undefined;\n  const currentValue = isControlled ? controlledValue : internalValue;\n\n  // Get the icon component\n  const getIcon = useCallback(() => {\n    if (typeof icon !== 'string') return icon;\n    switch (icon) {\n      case 'heart':\n        return <Heart />;\n      case 'circle':\n        return <Circle />;\n      case 'star':\n      default:\n        return <Star fill=\"currentColor\" />;\n    }\n  }, [icon]);\n\n  const IconComponent = getIcon();\n\n  // Calculate star state (empty, half, full)\n  const getStarState = useCallback(\n    (index: number) => {\n      const starValue = index + 1;\n      const displayValue = hoverValue !== null ? hoverValue : currentValue;\n\n      if (starValue <= Math.floor(displayValue)) {\n        return 'filled';\n      } else if (allowHalf && starValue === Math.ceil(displayValue) && displayValue % 1 !== 0) {\n        return 'half';\n      }\n      return 'empty';\n    },\n    [currentValue, hoverValue, allowHalf]\n  );\n\n  // Handle star click\n  const handleClick = useCallback(\n    (index: number, event: React.MouseEvent) => {\n      if (readOnly || disabled) return;\n\n      let newValue = index + 1;\n\n      // Half-star logic: if clicking the left half, set to .5\n      if (allowHalf) {\n        const rect = event.currentTarget.getBoundingClientRect();\n        const clickX = event.clientX - rect.left;\n        const halfWidth = rect.width / 2;\n\n        if (clickX < halfWidth) {\n          newValue = index + 0.5;\n        }\n      }\n\n      if (!isControlled) {\n        setInternalValue(newValue);\n      }\n      onChange?.(newValue);\n    },\n    [readOnly, disabled, allowHalf, isControlled, onChange]\n  );\n\n  // Handle hover\n  const handleMouseEnter = useCallback(\n    (index: number, event: React.MouseEvent) => {\n      if (readOnly || disabled) return;\n\n      let hoverVal = index + 1;\n\n      if (allowHalf) {\n        const rect = event.currentTarget.getBoundingClientRect();\n        const mouseX = event.clientX - rect.left;\n        const halfWidth = rect.width / 2;\n\n        if (mouseX < halfWidth) {\n          hoverVal = index + 0.5;\n        }\n      }\n\n      setHoverValue(hoverVal);\n    },\n    [readOnly, disabled, allowHalf]\n  );\n\n  const handleMouseLeave = useCallback(() => {\n    setHoverValue(null);\n  }, []);\n\n  // Keyboard navigation\n  const handleKeyDown = useCallback(\n    (event: KeyboardEvent<HTMLDivElement>) => {\n      if (readOnly || disabled) return;\n\n      const { key } = event;\n      let newIndex = focusedIndex;\n\n      if (key === 'ArrowLeft' || key === 'ArrowDown') {\n        event.preventDefault();\n        newIndex = Math.max(0, focusedIndex - 1);\n      } else if (key === 'ArrowRight' || key === 'ArrowUp') {\n        event.preventDefault();\n        newIndex = Math.min(count - 1, focusedIndex + 1);\n      } else if (key === ' ' || key === 'Enter') {\n        event.preventDefault();\n        if (focusedIndex >= 0) {\n          const newValue = focusedIndex + 1;\n          if (!isControlled) {\n            setInternalValue(newValue);\n          }\n          onChange?.(newValue);\n        }\n      } else if (key === 'Home') {\n        event.preventDefault();\n        newIndex = 0;\n      } else if (key === 'End') {\n        event.preventDefault();\n        newIndex = count - 1;\n      }\n\n      if (newIndex !== focusedIndex) {\n        setFocusedIndex(newIndex);\n      }\n    },\n    [readOnly, disabled, focusedIndex, count, isControlled, onChange]\n  );\n\n  // Reset focus on blur\n  const handleBlur = useCallback(() => {\n    setFocusedIndex(-1);\n  }, []);\n\n  // Set initial focus on Tab\n  const handleFocus = useCallback(() => {\n    if (focusedIndex === -1) {\n      setFocusedIndex(Math.floor(currentValue) || 0);\n    }\n  }, [focusedIndex, currentValue]);\n\n  const containerClasses = [\n    styles.rating,\n    size !== 'md' && styles[size],\n    readOnly && styles.readonly,\n    disabled && styles.disabled,\n    typeof icon === 'string' && icon !== 'star' && styles[icon],\n    className,\n  ]\n    .filter(Boolean)\n    .join(' ');\n\n  const interactionProps =\n    !readOnly && !disabled\n      ? {\n          role: 'radiogroup',\n          'aria-label': ariaLabel || `Rate from 1 to ${count} ${typeof icon === 'string' ? icon + 's' : 'stars'}`,\n          tabIndex: 0,\n          onKeyDown: handleKeyDown,\n          onFocus: handleFocus,\n          onBlur: handleBlur,\n        }\n      : {\n          role: 'img',\n          'aria-label': ariaLabel || `Rated ${currentValue} out of ${count}${reviewCount ? ` based on ${reviewCount} reviews` : ''}`,\n        };\n\n  return (\n    <div className={styles.container}>\n      {label && <label className={styles.label}>{label}</label>}\n\n      <div className={styles.wrapper}>\n        <div\n          ref={containerRef}\n          className={containerClasses}\n          onMouseLeave={handleMouseLeave}\n          {...interactionProps}\n        >\n          {Array.from({ length: count }).map((_, index) => {\n            const state = getStarState(index);\n            const isFocused = focusedIndex === index;\n            const isInteractive = !readOnly && !disabled;\n\n            const starClasses = [\n              styles.star,\n              state === 'filled' && styles.filled,\n              state === 'half' && styles.half,\n              hoverValue !== null && styles.hover,\n              isFocused && styles.focused,\n            ]\n              .filter(Boolean)\n              .join(' ');\n\n            return (\n              <span\n                key={index}\n                className={starClasses}\n                onClick={(e) => handleClick(index, e)}\n                onMouseEnter={(e) => handleMouseEnter(index, e)}\n                onMouseMove={(e) => handleMouseEnter(index, e)}\n                data-value={index + 1}\n                role={isInteractive ? 'radio' : undefined}\n                aria-checked={isInteractive ? (index + 1 <= currentValue ? 'true' : 'false') : undefined}\n                aria-label={isInteractive ? `${index + 1} ${typeof icon === 'string' ? icon : 'star'}${index !== 0 ? 's' : ''}` : undefined}\n                aria-setsize={isInteractive ? count : undefined}\n                aria-posinset={isInteractive ? index + 1 : undefined}\n              >\n                {IconComponent}\n              </span>\n            );\n          })}\n        </div>\n\n        {showValue && (\n          <span className={styles.value}>\n            {currentValue} / {count}\n          </span>\n        )}\n\n        {reviewCount !== undefined && <span className={styles.count}>({reviewCount} reviews)</span>}\n      </div>\n\n      {description && <span className={styles.description}>{description}</span>}\n    </div>\n  );\n};\n\nRating.displayName = 'Rating';\n"],"names":["Rating","controlledValue","defaultValue","count","size","icon","allowHalf","readOnly","disabled","onChange","showValue","reviewCount","description","label","className","ariaLabel","internalValue","setInternalValue","useState","hoverValue","setHoverValue","focusedIndex","setFocusedIndex","containerRef","useRef","isControlled","currentValue","IconComponent","useCallback","Heart","Circle","jsx","Star","getStarState","index","starValue","displayValue","handleClick","event","newValue","rect","clickX","halfWidth","handleMouseEnter","hoverVal","mouseX","handleMouseLeave","handleKeyDown","key","newIndex","handleBlur","handleFocus","containerClasses","styles","interactionProps","jsxs","_","state","isFocused","isInteractive","starClasses","e"],"mappings":"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"}