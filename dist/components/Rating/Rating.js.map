{"version":3,"file":"Rating.js","sources":["../../../src/components/Rating/Rating.tsx"],"sourcesContent":["import React, { useState, useCallback, useRef, type KeyboardEvent } from 'react';\nimport { Star, Heart, Circle } from 'lucide-react';\nimport styles from './Rating.module.css';\n\nexport interface RatingProps {\n  /** Current rating value (controlled) */\n  value?: number;\n  /** Default rating value (uncontrolled) */\n  defaultValue?: number;\n  /** Total number of stars */\n  count?: number;\n  /** Size variant */\n  size?: 'sm' | 'md' | 'lg';\n  /** Icon type */\n  icon?: 'star' | 'heart' | 'circle' | React.ReactNode;\n  /** Allow half-star ratings */\n  allowHalf?: boolean;\n  /** Read-only mode (no interaction) */\n  readOnly?: boolean;\n  /** Disabled state */\n  disabled?: boolean;\n  /** Callback when value changes */\n  onChange?: (value: number) => void;\n  /** Show numeric value */\n  showValue?: boolean;\n  /** Show review count */\n  reviewCount?: number;\n  /** Description text */\n  description?: string;\n  /** Label text */\n  label?: string;\n  /** Additional CSS class */\n  className?: string;\n  /** Accessible label for the rating group */\n  ariaLabel?: string;\n}\n\n/**\n * Rating Component\n *\n * Star rating component for user feedback, reviews, and quality assessment.\n * Supports full and half-star ratings, keyboard navigation, and custom icons.\n *\n * @example\n * ```tsx\n * <Rating value={4} onChange={(val) => console.log(val)} />\n * <Rating defaultValue={3.5} allowHalf readOnly reviewCount={128} />\n * <Rating icon=\"heart\" size=\"lg\" />\n * ```\n */\nexport const Rating: React.FC<RatingProps> = ({\n  value: controlledValue,\n  defaultValue = 0,\n  count = 5,\n  size = 'md',\n  icon = 'star',\n  allowHalf = false,\n  readOnly = false,\n  disabled = false,\n  onChange,\n  showValue = false,\n  reviewCount,\n  description,\n  label,\n  className,\n  ariaLabel,\n}) => {\n  const [internalValue, setInternalValue] = useState(defaultValue);\n  const [hoverValue, setHoverValue] = useState<number | null>(null);\n  const [focusedIndex, setFocusedIndex] = useState<number>(-1);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const isControlled = controlledValue !== undefined;\n  const currentValue = isControlled ? controlledValue : internalValue;\n\n  // Get the icon component\n  const getIcon = useCallback(() => {\n    if (typeof icon !== 'string') return icon;\n    switch (icon) {\n      case 'heart':\n        return <Heart />;\n      case 'circle':\n        return <Circle />;\n      case 'star':\n      default:\n        return <Star fill=\"currentColor\" />;\n    }\n  }, [icon]);\n\n  const IconComponent = getIcon();\n\n  // Calculate star state (empty, half, full)\n  const getStarState = useCallback(\n    (index: number) => {\n      const starValue = index + 1;\n      const displayValue = hoverValue !== null ? hoverValue : currentValue;\n\n      if (starValue <= Math.floor(displayValue)) {\n        return 'filled';\n      } else if (allowHalf && starValue === Math.ceil(displayValue) && displayValue % 1 !== 0) {\n        return 'half';\n      }\n      return 'empty';\n    },\n    [currentValue, hoverValue, allowHalf]\n  );\n\n  // Handle star click\n  const handleClick = useCallback(\n    (index: number, event: React.MouseEvent) => {\n      if (readOnly || disabled) return;\n\n      let newValue = index + 1;\n\n      // Half-star logic: if clicking the left half, set to .5\n      if (allowHalf) {\n        const rect = event.currentTarget.getBoundingClientRect();\n        const clickX = event.clientX - rect.left;\n        const halfWidth = rect.width / 2;\n\n        if (clickX < halfWidth) {\n          newValue = index + 0.5;\n        }\n      }\n\n      if (!isControlled) {\n        setInternalValue(newValue);\n      }\n      onChange?.(newValue);\n    },\n    [readOnly, disabled, allowHalf, isControlled, onChange]\n  );\n\n  // Handle hover\n  const handleMouseEnter = useCallback(\n    (index: number, event: React.MouseEvent) => {\n      if (readOnly || disabled) return;\n\n      let hoverVal = index + 1;\n\n      if (allowHalf) {\n        const rect = event.currentTarget.getBoundingClientRect();\n        const mouseX = event.clientX - rect.left;\n        const halfWidth = rect.width / 2;\n\n        if (mouseX < halfWidth) {\n          hoverVal = index + 0.5;\n        }\n      }\n\n      setHoverValue(hoverVal);\n    },\n    [readOnly, disabled, allowHalf]\n  );\n\n  const handleMouseLeave = useCallback(() => {\n    setHoverValue(null);\n  }, []);\n\n  // Keyboard navigation\n  const handleKeyDown = useCallback(\n    (event: KeyboardEvent<HTMLDivElement>) => {\n      if (readOnly || disabled) return;\n\n      const { key } = event;\n      let newIndex = focusedIndex;\n\n      if (key === 'ArrowLeft' || key === 'ArrowDown') {\n        event.preventDefault();\n        newIndex = Math.max(0, focusedIndex - 1);\n      } else if (key === 'ArrowRight' || key === 'ArrowUp') {\n        event.preventDefault();\n        newIndex = Math.min(count - 1, focusedIndex + 1);\n      } else if (key === ' ' || key === 'Enter') {\n        event.preventDefault();\n        if (focusedIndex >= 0) {\n          const newValue = focusedIndex + 1;\n          if (!isControlled) {\n            setInternalValue(newValue);\n          }\n          onChange?.(newValue);\n        }\n      } else if (key === 'Home') {\n        event.preventDefault();\n        newIndex = 0;\n      } else if (key === 'End') {\n        event.preventDefault();\n        newIndex = count - 1;\n      }\n\n      if (newIndex !== focusedIndex) {\n        setFocusedIndex(newIndex);\n      }\n    },\n    [readOnly, disabled, focusedIndex, count, isControlled, onChange]\n  );\n\n  // Reset focus on blur\n  const handleBlur = useCallback(() => {\n    setFocusedIndex(-1);\n  }, []);\n\n  // Set initial focus on Tab\n  const handleFocus = useCallback(() => {\n    if (focusedIndex === -1) {\n      setFocusedIndex(Math.floor(currentValue) || 0);\n    }\n  }, [focusedIndex, currentValue]);\n\n  const containerClasses = [\n    styles.rating,\n    size !== 'md' && styles[size],\n    readOnly && styles.readonly,\n    disabled && styles.disabled,\n    typeof icon === 'string' && icon !== 'star' && styles[icon],\n    className,\n  ]\n    .filter(Boolean)\n    .join(' ');\n\n  const interactionProps =\n    !readOnly && !disabled\n      ? {\n          role: 'radiogroup',\n          'aria-label': ariaLabel || `Rate from 1 to ${count} ${typeof icon === 'string' ? icon + 's' : 'stars'}`,\n          tabIndex: 0,\n          onKeyDown: handleKeyDown,\n          onFocus: handleFocus,\n          onBlur: handleBlur,\n        }\n      : {\n          role: 'img',\n          'aria-label': ariaLabel || `Rated ${currentValue} out of ${count}${reviewCount ? ` based on ${reviewCount} reviews` : ''}`,\n        };\n\n  return (\n    <div className={styles.container}>\n      {label && <label className={styles.label}>{label}</label>}\n\n      <div className={styles.wrapper}>\n        <div\n          ref={containerRef}\n          className={containerClasses}\n          onMouseLeave={handleMouseLeave}\n          {...interactionProps}\n        >\n          {Array.from({ length: count }).map((_, index) => {\n            const state = getStarState(index);\n            const isFocused = focusedIndex === index;\n            const isInteractive = !readOnly && !disabled;\n\n            const starClasses = [\n              styles.star,\n              state === 'filled' && styles.filled,\n              state === 'half' && styles.half,\n              hoverValue !== null && styles.hover,\n              isFocused && styles.focused,\n            ]\n              .filter(Boolean)\n              .join(' ');\n\n            return (\n              <span\n                key={index}\n                className={starClasses}\n                onClick={(e) => handleClick(index, e)}\n                onMouseEnter={(e) => handleMouseEnter(index, e)}\n                onMouseMove={(e) => handleMouseEnter(index, e)}\n                data-value={index + 1}\n                role={isInteractive ? 'radio' : undefined}\n                aria-checked={isInteractive ? (index + 1 <= currentValue ? 'true' : 'false') : undefined}\n                aria-label={isInteractive ? `${index + 1} ${typeof icon === 'string' ? icon : 'star'}${index !== 0 ? 's' : ''}` : undefined}\n                aria-setsize={isInteractive ? count : undefined}\n                aria-posinset={isInteractive ? index + 1 : undefined}\n              >\n                {IconComponent}\n              </span>\n            );\n          })}\n        </div>\n\n        {showValue && (\n          <span className={styles.value}>\n            {currentValue} / {count}\n          </span>\n        )}\n\n        {reviewCount !== undefined && <span className={styles.count}>({reviewCount} reviews)</span>}\n      </div>\n\n      {description && <span className={styles.description}>{description}</span>}\n    </div>\n  );\n};\n\nRating.displayName = 'Rating';\n"],"names":["Rating","controlledValue","defaultValue","count","size","icon","allowHalf","readOnly","disabled","onChange","showValue","reviewCount","description","label","className","ariaLabel","internalValue","setInternalValue","useState","hoverValue","setHoverValue","focusedIndex","setFocusedIndex","containerRef","useRef","isControlled","currentValue","IconComponent","useCallback","Heart","Circle","jsx","Star","getStarState","index","starValue","displayValue","handleClick","event","newValue","rect","clickX","halfWidth","handleMouseEnter","hoverVal","mouseX","handleMouseLeave","handleKeyDown","key","newIndex","handleBlur","handleFocus","containerClasses","styles","interactionProps","jsxs","_","state","isFocused","isInteractive","starClasses","e"],"mappings":"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"}