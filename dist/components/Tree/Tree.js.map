{"version":3,"file":"Tree.js","sources":["../../../src/components/Tree/Tree.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { ChevronDown, ChevronRight } from 'lucide-react';\nimport styles from './Tree.module.css';\n\n// ===== Types =====\n\nexport interface TreeNodeData {\n  id: string;\n  label: React.ReactNode;\n  icon?: React.ReactNode;\n  children?: TreeNodeData[];\n  badge?: React.ReactNode;\n  disabled?: boolean;\n}\n\nexport interface TreeProps {\n  data: TreeNodeData[];\n  selectable?: boolean;\n  compact?: boolean;\n  defaultExpandAll?: boolean;\n  onSelect?: (nodeIds: string[]) => void;\n  className?: string;\n}\n\ninterface TreeNodeProps {\n  node: TreeNodeData;\n  level: number;\n  selectable?: boolean;\n  compact?: boolean;\n  expandedNodes: Set<string>;\n  selectedNodes: Set<string>;\n  onToggle: (nodeId: string) => void;\n  onCheck: (nodeId: string, checked: boolean) => void;\n  onNodeClick: (nodeId: string) => void;\n}\n\n// ===== Tree Node Component =====\n\nconst TreeNode: React.FC<TreeNodeProps> = ({\n  node,\n  level,\n  selectable,\n  compact,\n  expandedNodes,\n  selectedNodes,\n  onToggle,\n  onCheck,\n  onNodeClick,\n}) => {\n  const hasChildren = node.children && node.children.length > 0;\n  const isExpanded = expandedNodes.has(node.id);\n  const isSelected = selectedNodes.has(node.id);\n  const isLeaf = !hasChildren;\n\n  const handleExpandClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    if (hasChildren) {\n      onToggle(node.id);\n    }\n  };\n\n  const handleCheckboxChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    e.stopPropagation();\n    onCheck(node.id, e.target.checked);\n  };\n\n  const handleContentClick = () => {\n    if (!selectable && !node.disabled) {\n      onNodeClick(node.id);\n    }\n  };\n\n  const nodeClasses = [\n    styles.treeNode,\n    isLeaf && styles.treeNodeLeaf,\n    node.disabled && styles.treeNodeDisabled,\n    isSelected && !selectable && styles.treeNodeSelected,\n  ]\n    .filter(Boolean)\n    .join(' ');\n\n  return (\n    <div className={nodeClasses}>\n      <div\n        className={styles.treeNodeContent}\n        onClick={handleContentClick}\n        role={!selectable ? 'button' : undefined}\n        tabIndex={!selectable && !node.disabled ? 0 : undefined}\n      >\n        {hasChildren ? (\n          <button\n            className={`${styles.treeExpandBtn} ${\n              isExpanded ? styles.treeExpandBtnExpanded : styles.treeExpandBtnCollapsed\n            }`}\n            onClick={handleExpandClick}\n            aria-expanded={isExpanded}\n            aria-label={isExpanded ? 'Collapse' : 'Expand'}\n          >\n            {isExpanded ? <ChevronDown size={16} /> : <ChevronRight size={16} />}\n          </button>\n        ) : (\n          <span className={styles.treeIndent} />\n        )}\n\n        {selectable && (\n          <input\n            type=\"checkbox\"\n            className={styles.treeCheckbox}\n            checked={isSelected}\n            onChange={handleCheckboxChange}\n            disabled={node.disabled}\n            onClick={(e) => e.stopPropagation()}\n          />\n        )}\n\n        {node.icon && <span className={styles.treeIcon}>{node.icon}</span>}\n\n        <span className={styles.treeLabel}>\n          <span className={styles.treeLabelText}>{node.label}</span>\n        </span>\n\n        {node.badge && <span className={styles.treeBadge}>{node.badge}</span>}\n      </div>\n\n      {hasChildren && isExpanded && (\n        <div className={styles.treeChildren}>\n          {node.children!.map((child) => (\n            <TreeNode\n              key={child.id}\n              node={child}\n              level={level + 1}\n              selectable={selectable}\n              compact={compact}\n              expandedNodes={expandedNodes}\n              selectedNodes={selectedNodes}\n              onToggle={onToggle}\n              onCheck={onCheck}\n              onNodeClick={onNodeClick}\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\n// ===== Main Tree Component =====\n\nconst Tree: React.FC<TreeProps> = ({\n  data,\n  selectable = false,\n  compact = false,\n  defaultExpandAll = false,\n  onSelect,\n  className = '',\n}) => {\n  // Initialize expanded nodes\n  const getDefaultExpandedNodes = (): Set<string> => {\n    if (!defaultExpandAll) return new Set();\n\n    const expandedSet = new Set<string>();\n    const traverse = (nodes: TreeNodeData[]) => {\n      nodes.forEach((node) => {\n        if (node.children && node.children.length > 0) {\n          expandedSet.add(node.id);\n          traverse(node.children);\n        }\n      });\n    };\n    traverse(data);\n    return expandedSet;\n  };\n\n  const [expandedNodes, setExpandedNodes] = useState<Set<string>>(getDefaultExpandedNodes());\n  const [selectedNodes, setSelectedNodes] = useState<Set<string>>(new Set());\n\n  const handleToggle = (nodeId: string) => {\n    setExpandedNodes((prev) => {\n      const newSet = new Set(prev);\n      if (newSet.has(nodeId)) {\n        newSet.delete(nodeId);\n      } else {\n        newSet.add(nodeId);\n      }\n      return newSet;\n    });\n  };\n\n  const handleCheck = (nodeId: string, checked: boolean) => {\n    const newSelectedNodes = new Set(selectedNodes);\n\n    // Helper to get all descendant IDs\n    const getDescendantIds = (nodes: TreeNodeData[]): string[] => {\n      let ids: string[] = [];\n      nodes.forEach((node) => {\n        ids.push(node.id);\n        if (node.children) {\n          ids = ids.concat(getDescendantIds(node.children));\n        }\n      });\n      return ids;\n    };\n\n    // Find the node in the tree\n    const findNode = (nodes: TreeNodeData[], id: string): TreeNodeData | null => {\n      for (const node of nodes) {\n        if (node.id === id) return node;\n        if (node.children) {\n          const found = findNode(node.children, id);\n          if (found) return found;\n        }\n      }\n      return null;\n    };\n\n    const targetNode = findNode(data, nodeId);\n    if (!targetNode) return;\n\n    // Update current node and all descendants\n    if (checked) {\n      newSelectedNodes.add(nodeId);\n      if (targetNode.children) {\n        getDescendantIds(targetNode.children).forEach((id) => newSelectedNodes.add(id));\n      }\n    } else {\n      newSelectedNodes.delete(nodeId);\n      if (targetNode.children) {\n        getDescendantIds(targetNode.children).forEach((id) => newSelectedNodes.delete(id));\n      }\n    }\n\n    setSelectedNodes(newSelectedNodes);\n    if (onSelect) {\n      onSelect(Array.from(newSelectedNodes));\n    }\n  };\n\n  const handleNodeClick = (nodeId: string) => {\n    setSelectedNodes(new Set([nodeId]));\n    if (onSelect) {\n      onSelect([nodeId]);\n    }\n  };\n\n  const treeClasses = [\n    styles.tree,\n    selectable && styles.treeSelectable,\n    compact && styles.treeCompact,\n    className,\n  ]\n    .filter(Boolean)\n    .join(' ');\n\n  return (\n    <div className={treeClasses}>\n      {data.map((node) => (\n        <TreeNode\n          key={node.id}\n          node={node}\n          level={0}\n          selectable={selectable}\n          compact={compact}\n          expandedNodes={expandedNodes}\n          selectedNodes={selectedNodes}\n          onToggle={handleToggle}\n          onCheck={handleCheck}\n          onNodeClick={handleNodeClick}\n        />\n      ))}\n    </div>\n  );\n};\n\nexport { Tree };\n"],"names":["TreeNode","node","level","selectable","compact","expandedNodes","selectedNodes","onToggle","onCheck","onNodeClick","hasChildren","isExpanded","isSelected","isLeaf","handleExpandClick","handleCheckboxChange","handleContentClick","nodeClasses","styles","jsxs","jsx","ChevronDown","ChevronRight","child","Tree","data","defaultExpandAll","onSelect","className","getDefaultExpandedNodes","expandedSet","traverse","nodes","setExpandedNodes","useState","setSelectedNodes","handleToggle","nodeId","prev","newSet","handleCheck","checked","newSelectedNodes","getDescendantIds","ids","findNode","id","found","targetNode","handleNodeClick","treeClasses"],"mappings":"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"}