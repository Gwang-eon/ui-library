"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const s=require("react/jsx-runtime"),u=require("react"),M=require("lucide-react"),a=require("./FileUpload.module.css.cjs"),H=({label:k,helperText:g,accept:f,maxSize:h=10*1024*1024,maxFiles:x=10,multiple:o=!1,disabled:l=!1,showPreview:j=!1,useNativeInput:A=!1,icon:y,uploadText:E="Click to upload or drag and drop",hintText:w,onFilesChange:N,onFileRemove:U,validator:D,className:q=""})=>{const[d,m]=u.useState([]),[O,F]=u.useState(!1),p=u.useRef(null),C=u.useRef(null),P=()=>`file-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,b=u.useCallback(e=>{if(D){const t=D(e);if(t)return t}if(h&&e.size>h)return`File size exceeds ${(h/1024/1024).toFixed(0)}MB limit`;if(f){const t=f.split(",").map(n=>n.trim()),r=`.${e.name.split(".").pop()?.toLowerCase()}`,c=e.type;if(!t.some(n=>{if(n.startsWith("."))return r===n.toLowerCase();if(n.includes("*")){const[v]=n.split("/");return c.startsWith(v)}return c===n}))return"File type not supported"}return null},[f,h,D]),R=u.useCallback(e=>{const t=[],r=Array.from(e);if(!o&&r.length>1&&r.splice(1),(o?d.length+r.length:r.length)>x){alert(`Maximum ${x} files allowed`);return}r.forEach(i=>{const n=b(i),v=Object.assign(i,{id:P(),status:n?"error":"idle",error:n??void 0});if(j&&i.type.startsWith("image/")&&!n){const L=new FileReader;L.onload=X=>{const Z=X.target?.result;m(_=>_.map($=>$.id===v.id?{...$,preview:Z}:$))},L.readAsDataURL(i)}t.push(v)}),o?(m(i=>[...i,...t]),N?.([...d,...t])):(m(t),N?.(t))},[d,o,x,b,j,N]),z=e=>{const t=e.target.files;t&&t.length>0&&R(t)},S=e=>{e.preventDefault(),e.stopPropagation(),l||F(!0)},W=e=>{e.preventDefault(),e.stopPropagation(),e.currentTarget===C.current&&F(!1)},I=e=>{e.preventDefault(),e.stopPropagation()},K=e=>{if(e.preventDefault(),e.stopPropagation(),F(!1),l)return;const t=e.dataTransfer.files;t.length>0&&R(t)},B=()=>{l||p.current?.click()},G=e=>{m(t=>t.filter(r=>r.id!==e.id)),U?.(e),d.length===1&&p.current&&(p.current.value="")},T=e=>{if(e===0)return"0 Bytes";const t=1024,r=["Bytes","KB","MB","GB"],c=Math.floor(Math.log(e)/Math.log(t));return Math.round(e/Math.pow(t,c)*100)/100+" "+r[c]};return s.jsxs("div",{className:`${a.default["upload-container"]} ${q}`,children:[k&&s.jsx("label",{className:a.default.label,children:k}),A?s.jsxs(s.Fragment,{children:[s.jsx("input",{ref:p,type:"file",accept:f,multiple:o,onChange:z,disabled:l,className:a.default["input-file"]}),g&&s.jsx("p",{className:a.default["helper-text"],children:g})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{ref:C,className:`${a.default["upload-area"]} ${O?a.default.dragging:""} ${l?a.default.disabled:""}`,onClick:B,onDragEnter:S,onDragLeave:W,onDragOver:I,onDrop:K,role:"button",tabIndex:l?-1:0,"aria-label":"File upload area",onKeyDown:e=>{(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),B())},children:[s.jsx("input",{ref:p,type:"file",accept:f,multiple:o,onChange:z,disabled:l,style:{display:"none"},"aria-hidden":"true"}),y&&s.jsx("div",{className:a.default["upload-icon"],children:y}),!y&&s.jsx("div",{className:a.default["upload-icon"],children:s.jsx(M.UploadCloud,{size:48})}),s.jsx("div",{className:a.default["upload-text"],children:E}),w&&s.jsx("div",{className:a.default["upload-hint"],children:w})]}),g&&s.jsx("p",{className:a.default["helper-text"],children:g})]}),d.length>0&&s.jsx("div",{className:a.default["file-list"],children:d.map(e=>s.jsxs("div",{className:`${a.default["file-item"]} ${e.status==="error"?a.default["file-error"]:""} ${e.status==="success"?a.default["file-success"]:""}`,children:[j&&e.preview&&s.jsx("div",{className:a.default["file-preview"],children:s.jsx("img",{src:e.preview,alt:e.name})}),!e.preview&&s.jsx("div",{className:a.default["file-icon"],children:s.jsx(M.FileText,{size:24})}),s.jsxs("div",{className:a.default["file-info"],children:[s.jsx("div",{className:a.default["file-name"],children:e.name}),s.jsx("div",{className:a.default["file-size"],children:T(e.size)}),e.error&&s.jsx("div",{className:a.default["file-error-msg"],children:e.error})]}),e.status==="uploading"&&e.progress!==void 0&&s.jsxs("div",{className:a.default["upload-file-progress"],children:[s.jsx("div",{style:{flex:1,height:"4px",backgroundColor:"var(--color-gray-200)",borderRadius:"var(--radius-full)",overflow:"hidden"},children:s.jsx("div",{style:{width:`${e.progress}%`,height:"100%",backgroundColor:"var(--color-primary-500)",transition:"width var(--duration-normal) var(--ease-out)"}})}),s.jsxs("span",{style:{marginLeft:"var(--spacing-2)",fontSize:"var(--font-size-body-small)",color:"var(--text-secondary)"},children:[e.progress,"%"]})]}),e.status!=="uploading"&&s.jsx("button",{type:"button",className:a.default["remove-btn"],onClick:t=>{t.stopPropagation(),G(e)},"aria-label":`Remove ${e.name}`,children:s.jsx(M.X,{size:18})})]},e.id))})]})};exports.FileUpload=H;
//# sourceMappingURL=FileUpload.cjs.map
