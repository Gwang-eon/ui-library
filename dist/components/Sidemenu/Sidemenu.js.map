{"version":3,"file":"Sidemenu.js","sources":["../../../src/components/Sidemenu/Sidemenu.tsx"],"sourcesContent":["import { useState } from 'react';\nimport type { ReactNode } from 'react';\nimport styles from './Sidemenu.module.css';\n\nexport interface SidemenuItem {\n  /** Unique key */\n  key: string;\n  /** Display title */\n  title: string;\n  /** Icon before title */\n  icon?: ReactNode;\n  /** Link href */\n  href?: string;\n  /** Badge count or text */\n  badge?: ReactNode;\n  /** Nested child items */\n  children?: SidemenuItem[];\n  /** Disabled state */\n  disabled?: boolean;\n  /** Tooltip for collapsed mode */\n  tooltip?: string;\n}\n\nexport interface SidemenuGroup {\n  /** Group header text */\n  title: string;\n  /** Group icon */\n  icon?: ReactNode;\n  /** Group items */\n  items: SidemenuItem[];\n}\n\nexport interface SidemenuProps {\n  /** Menu items or grouped items */\n  items: (SidemenuItem | SidemenuGroup)[];\n  /** Active item key */\n  activeKey?: string;\n  /** Collapsed state (controlled) */\n  collapsed?: boolean;\n  /** Default collapsed state */\n  defaultCollapsed?: boolean;\n  /** Callback when collapsed changes */\n  onCollapse?: (collapsed: boolean) => void;\n  /** Callback when active item changes */\n  onSelect?: (key: string) => void;\n  /** Brand logo/icon */\n  brandIcon?: ReactNode;\n  /** Brand text */\n  brandText?: string;\n  /** User info */\n  userInfo?: {\n    name: string;\n    email?: string;\n    avatar?: string | ReactNode;\n  };\n  /** Show search */\n  showSearch?: boolean;\n  /** Search placeholder */\n  searchPlaceholder?: string;\n  /** Additional CSS classes */\n  className?: string;\n  /** Storage key for persistence */\n  storageKey?: string;\n}\n\nconst isGroup = (item: SidemenuItem | SidemenuGroup): item is SidemenuGroup => {\n  return 'items' in item && Array.isArray(item.items);\n};\n\n/**\n * Sidemenu - Enterprise-grade side navigation\n *\n * Features:\n * - Collapsible mode (280px → 64px)\n * - Multi-level hierarchy\n * - Search functionality\n * - Group headers\n * - Persistent state\n *\n * @example\n * ```tsx\n * <Sidemenu\n *   items={[\n *     { key: 'dashboard', title: 'Dashboard', icon: <Home />, href: '#' }\n *   ]}\n *   brandText=\"IoT Platform\"\n *   defaultCollapsed={false}\n * />\n * ```\n */\nexport const Sidemenu = ({\n  items,\n  activeKey,\n  collapsed: controlledCollapsed,\n  defaultCollapsed = false,\n  onCollapse,\n  onSelect,\n  brandIcon,\n  brandText = 'App',\n  userInfo,\n  showSearch = false,\n  searchPlaceholder = 'Search menu...',\n  className = '',\n  storageKey = 'sidemenu-collapsed',\n}: SidemenuProps) => {\n  const [uncontrolledCollapsed, setUncontrolledCollapsed] = useState(() => {\n    if (storageKey && typeof window !== 'undefined') {\n      const stored = localStorage.getItem(storageKey);\n      return stored ? stored === 'true' : defaultCollapsed;\n    }\n    return defaultCollapsed;\n  });\n\n  const [searchQuery, setSearchQuery] = useState('');\n  const [expandedKeys, setExpandedKeys] = useState<Set<string>>(new Set());\n\n  const isCollapsed =\n    controlledCollapsed !== undefined ? controlledCollapsed : uncontrolledCollapsed;\n\n  const handleToggleCollapse = () => {\n    const newCollapsed = !isCollapsed;\n    if (controlledCollapsed === undefined) {\n      setUncontrolledCollapsed(newCollapsed);\n      if (storageKey && typeof window !== 'undefined') {\n        localStorage.setItem(storageKey, String(newCollapsed));\n      }\n    }\n    onCollapse?.(newCollapsed);\n  };\n\n  const handleItemClick = (item: SidemenuItem, e: React.MouseEvent) => {\n    if (item.disabled) {\n      e.preventDefault();\n      return;\n    }\n\n    if (item.children && item.children.length > 0) {\n      e.preventDefault();\n      setExpandedKeys((prev) => {\n        const next = new Set(prev);\n        if (next.has(item.key)) {\n          next.delete(item.key);\n        } else {\n          next.add(item.key);\n        }\n        return next;\n      });\n    } else {\n      onSelect?.(item.key);\n    }\n  };\n\n  const matchesSearch = (item: SidemenuItem, query: string): boolean => {\n    if (!query) return true;\n    const q = query.toLowerCase();\n    const titleMatch = item.title.toLowerCase().includes(q);\n    const childMatch =\n      item.children?.some((child) => matchesSearch(child, query)) || false;\n    return titleMatch || childMatch;\n  };\n\n  const renderMenuItem = (item: SidemenuItem, level = 0): ReactNode => {\n    if (!matchesSearch(item, searchQuery)) return null;\n\n    const isExpanded = expandedKeys.has(item.key);\n    const isActive = activeKey === item.key;\n    const hasChildren = item.children && item.children.length > 0;\n\n    const itemClass = [\n      styles.sidemenuItem,\n      isActive && styles.active,\n      hasChildren && styles.sidemenuItemParent,\n      isExpanded && styles.expanded,\n      level > 0 && styles.sidemenuItemChild,\n      item.disabled && styles.disabled,\n    ]\n      .filter(Boolean)\n      .join(' ');\n\n    const ItemTag = item.href ? 'a' : 'div';\n\n    return (\n      <div key={item.key}>\n        <ItemTag\n          href={item.href}\n          className={itemClass}\n          onClick={(e) => handleItemClick(item, e as any)}\n          data-tooltip={isCollapsed ? item.tooltip || item.title : undefined}\n          aria-current={isActive ? 'page' : undefined}\n          aria-expanded={hasChildren ? isExpanded : undefined}\n        >\n          {item.icon && <span className={styles.sidemenuIcon}>{item.icon}</span>}\n          <span className={styles.sidemenuLabel}>{item.title}</span>\n          {item.badge && <span className={styles.sidemenuBadge}>{item.badge}</span>}\n          {hasChildren && !isCollapsed && (\n            <span className={styles.sidemenuChevron}>\n              {isExpanded ? '▼' : '▶'}\n            </span>\n          )}\n        </ItemTag>\n\n        {hasChildren && !isCollapsed && isExpanded && (\n          <div className={styles.sidemenuSubmenu} data-level={level + 1}>\n            {item.children!.map((child) => renderMenuItem(child, level + 1))}\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  const renderGroup = (group: SidemenuGroup): ReactNode => {\n    return (\n      <div key={group.title} className={styles.sidemenuGroupWrapper}>\n        <div className={styles.sidemenuGroupHeader}>\n          {group.icon && <span>{group.icon}</span>}\n          <span>{group.title}</span>\n        </div>\n        {group.items.map((item) => renderMenuItem(item))}\n      </div>\n    );\n  };\n\n  const renderUserAvatar = () => {\n    if (!userInfo) return null;\n\n    if (typeof userInfo.avatar === 'string') {\n      if (userInfo.avatar.startsWith('http')) {\n        return <img src={userInfo.avatar} alt={userInfo.name} />;\n      }\n      return <div className={styles.sidemenuUserAvatar}>{userInfo.avatar}</div>;\n    }\n\n    if (userInfo.avatar) {\n      return userInfo.avatar;\n    }\n\n    // Default to initials\n    const initials = userInfo.name\n      .split(' ')\n      .map((n) => n[0])\n      .join('')\n      .toUpperCase()\n      .slice(0, 2);\n\n    return <div className={styles.sidemenuUserAvatar}>{initials}</div>;\n  };\n\n  return (\n    <nav\n      className={`${styles.sidemenu} ${isCollapsed ? styles.collapsed : ''} ${className}`}\n      role=\"navigation\"\n      aria-label=\"Main navigation\"\n    >\n      {/* Header */}\n      <div className={styles.sidemenuHeader}>\n        {brandIcon && <span className={styles.sidemenuBrandIcon}>{brandIcon}</span>}\n        <span className={styles.sidemenuBrandText}>{brandText}</span>\n        <button\n          className={styles.sidemenuCollapseBtn}\n          onClick={handleToggleCollapse}\n          aria-label={isCollapsed ? 'Expand sidebar' : 'Collapse sidebar'}\n          aria-expanded={!isCollapsed}\n        >\n          <span>{isCollapsed ? '→' : '←'}</span>\n        </button>\n      </div>\n\n      {/* Search */}\n      {showSearch && !isCollapsed && (\n        <div className={styles.sidemenuSearch}>\n          <input\n            type=\"text\"\n            className={styles.sidemenuSearchInput}\n            placeholder={searchPlaceholder}\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            aria-label=\"Search menu\"\n          />\n        </div>\n      )}\n\n      {/* Navigation */}\n      <div className={styles.sidemenuNav}>\n        {items.map((item) => {\n          if (isGroup(item)) {\n            return renderGroup(item);\n          }\n          return renderMenuItem(item);\n        })}\n      </div>\n\n      {/* Footer */}\n      {userInfo && (\n        <div className={styles.sidemenuFooter}>\n          <div className={styles.sidemenuUser}>\n            {renderUserAvatar()}\n            <div className={styles.sidemenuUserInfo}>\n              <div className={styles.sidemenuUserName}>{userInfo.name}</div>\n              {userInfo.email && (\n                <div className={styles.sidemenuUserEmail}>{userInfo.email}</div>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n    </nav>\n  );\n};\n"],"names":["isGroup","item","Sidemenu","items","activeKey","controlledCollapsed","defaultCollapsed","onCollapse","onSelect","brandIcon","brandText","userInfo","showSearch","searchPlaceholder","className","storageKey","uncontrolledCollapsed","setUncontrolledCollapsed","useState","stored","searchQuery","setSearchQuery","expandedKeys","setExpandedKeys","isCollapsed","handleToggleCollapse","newCollapsed","handleItemClick","e","prev","next","matchesSearch","query","q","titleMatch","childMatch","child","renderMenuItem","level","isExpanded","isActive","hasChildren","itemClass","styles","ItemTag","jsxs","jsx","renderGroup","group","renderUserAvatar","initials","n"],"mappings":"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"}