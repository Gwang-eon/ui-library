"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const t=require("react/jsx-runtime"),o=require("react"),w=require("lucide-react"),l=require("./Autocomplete.module.css.cjs"),B=(u,v)=>{const f=v.toLowerCase();return u.label.toLowerCase().includes(f)||u.value.toLowerCase().includes(f)||(u.description?.toLowerCase().includes(f)??!1)},T=({options:u,value:v,defaultValue:f,onChange:x,placeholder:k="Search...",loading:I=!1,disabled:y=!1,size:N="md",multiple:r=!1,emptyMessage:q="No results found",minChars:U=0,filterFn:z=B,className:K="","aria-label":M="Autocomplete"})=>{const p=v!==void 0,[H,D]=o.useState(f||(r?[]:"")),n=p?v:H,[b,S]=o.useState(""),[g,i]=o.useState(!1),[c,h]=o.useState(-1),A=o.useRef(null),R=o.useRef(null),$=o.useRef(null),m=b.length>=U?u.filter(e=>z(e,b)):u,j={};m.forEach(e=>{const a=e.category||"";j[a]||(j[a]=[]),j[a].push(e)});const L=Array.isArray(n)?n:n?[n]:[],V=o.useCallback(e=>{if(e.disabled)return;let a;if(r){const s=Array.isArray(n)?n:[];s.includes(e.value)?a=s.filter(d=>d!==e.value):a=[...s,e.value]}else a=e.value,S(""),i(!1);p||D(a),x?.(a)},[n,r,p,x]),W=o.useCallback(e=>{if(!r)return;const s=(Array.isArray(n)?n:[]).filter(d=>d!==e);p||D(s),x?.(s)},[n,r,p,x]),E=e=>{const a=e.target.value;S(a),i(!0),h(-1)},O=()=>{y||i(!0)},F=e=>{if(!g&&(e.key==="ArrowDown"||e.key==="ArrowUp")){i(!0),e.preventDefault();return}if(g)switch(e.key){case"ArrowDown":e.preventDefault(),h(a=>a<m.length-1?a+1:a);break;case"ArrowUp":e.preventDefault(),h(a=>a>0?a-1:0);break;case"Enter":e.preventDefault(),c>=0&&c<m.length&&V(m[c]);break;case"Escape":e.preventDefault(),i(!1),h(-1);break;case"Tab":i(!1);break}};o.useEffect(()=>{const e=a=>{A.current&&!A.current.contains(a.target)&&i(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),o.useEffect(()=>{if(c>=0&&$.current){const e=$.current.children[c];e&&e.scrollIntoView&&e.scrollIntoView({block:"nearest"})}},[c]);const C=u.filter(e=>L.includes(e.value)),X=N!=="md"?l.default[`autocomplete${N.charAt(0).toUpperCase()+N.slice(1)}`]:"",P=r?l.default.autocompleteMultiple:"";return t.jsxs("div",{ref:A,className:`${l.default.autocomplete} ${X} ${P} ${K}`,role:"combobox","aria-expanded":g,"aria-haspopup":"listbox","aria-owns":"autocomplete-listbox","aria-label":M,children:[t.jsxs("div",{className:`${l.default.autocompleteInputWrapper} ${I?l.default.autocompleteLoading:""}`,children:[r&&C.length>0&&t.jsxs("div",{className:l.default.autocompleteTags,children:[C.map(e=>t.jsxs("span",{className:"tag tag-sm tag-primary",children:[e.label,t.jsx("button",{type:"button",className:"tag-remove",onClick:()=>W(e.value),"aria-label":`Remove ${e.label}`,children:t.jsx(w.X,{size:14})})]},e.value)),t.jsx("input",{ref:R,type:"text",className:`${l.default.autocompleteInput} ${l.default.autocompleteInputInline}`,value:b,onChange:E,onFocus:O,onKeyDown:F,placeholder:C.length>0?"Add more...":k,disabled:y,"aria-autocomplete":"list","aria-controls":"autocomplete-listbox","aria-activedescendant":c>=0?`autocomplete-option-${c}`:void 0})]}),!r&&t.jsxs(t.Fragment,{children:[t.jsx("input",{ref:R,type:"text",className:l.default.autocompleteInput,value:b,onChange:E,onFocus:O,onKeyDown:F,placeholder:k,disabled:y,"aria-autocomplete":"list","aria-controls":"autocomplete-listbox","aria-activedescendant":c>=0?`autocomplete-option-${c}`:void 0}),I?t.jsx(w.Loader2,{className:l.default.autocompleteSpinner,size:20}):t.jsx(w.Search,{className:l.default.autocompleteIcon,size:20})]})]}),g&&t.jsx("div",{ref:$,className:l.default.autocompleteDropdown,role:"listbox",id:"autocomplete-listbox","aria-label":"Suggestions",children:I?t.jsx("div",{className:l.default.autocompleteLoadingText,children:"Loading results..."}):m.length===0?t.jsxs("div",{className:l.default.autocompleteEmpty,children:[t.jsx(w.SearchX,{size:48}),t.jsx("p",{children:q}),t.jsx("span",{children:"Try adjusting your search terms"})]}):Object.entries(j).map(([e,a])=>t.jsxs("div",{children:[e&&t.jsx("div",{className:l.default.autocompleteCategory,children:e}),a.map(s=>{const d=m.indexOf(s),Q=d===c,_=L.includes(s.value);return t.jsx("div",{id:`autocomplete-option-${d}`,role:"option","aria-selected":_,"aria-disabled":s.disabled,className:`${l.default.autocompleteItem} ${s.description?l.default.autocompleteItemWithDesc:""} ${Q?l.default.autocompleteItemActive:""} ${s.disabled?l.default.autocompleteItemDisabled:""}`,onClick:()=>V(s),onMouseEnter:()=>h(d),children:s.description?t.jsxs(t.Fragment,{children:[s.icon&&t.jsx("div",{className:l.default.autocompleteItemIcon,children:s.icon}),t.jsxs("div",{className:l.default.autocompleteItemContent,children:[t.jsx("div",{className:l.default.autocompleteItemTitle,children:s.label}),t.jsx("div",{className:l.default.autocompleteItemDescription,children:s.description})]})]}):t.jsxs(t.Fragment,{children:[s.icon,t.jsx("span",{children:s.label})]})},s.value)})]},e))})]})};T.displayName="Autocomplete";exports.Autocomplete=T;
//# sourceMappingURL=Autocomplete.cjs.map
