"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const o=require("react/jsx-runtime"),i=require("react"),X=require("react-dom"),K=require("lucide-react"),v=require("../Button/Button.cjs"),t=require("./Tour.module.css.cjs"),N=({open:s,steps:d,current:w,onChange:S,onClose:h,onFinish:R,onSkip:P,mask:T=!0,closable:L=!0,showSkip:C=!0,showProgress:q=!0,placement:f="bottom","aria-label":$="Product tour"})=>{const[H,M]=i.useState(0),[b,z]=i.useState({top:0,left:0}),[B,F]=i.useState(f),m=i.useRef(null),g=i.useRef(null),[p,A]=i.useState(null),y=w!==void 0,n=y?w:H,x=r=>{y||M(r),S?.(r)},l=d[n];i.useEffect(()=>{s?g.current=document.activeElement:g.current&&g.current.focus()},[s]),i.useEffect(()=>{if(!s||!l)return;document.querySelectorAll(`.${t.default.tourTargetHighlight}`).forEach(e=>{e.classList.remove(t.default.tourTargetHighlight)});const r=document.querySelector(l.target);return r&&(r.classList.add(t.default.tourTargetHighlight),A(r)),()=>{document.querySelectorAll(`.${t.default.tourTargetHighlight}`).forEach(e=>{e.classList.remove(t.default.tourTargetHighlight)})}},[s,l,n]),i.useEffect(()=>{if(!s||!p||!m.current)return;const r=()=>{const e=p.getBoundingClientRect(),a=m.current.getBoundingClientRect(),j=l?.placement||f;let u=0,c=0;switch(j){case"top":u=e.top-a.height-12,c=e.left+e.width/2-a.width/2;break;case"right":u=e.top+e.height/2-a.height/2,c=e.right+12;break;case"left":u=e.top+e.height/2-a.height/2,c=e.left-a.width-12;break;case"bottom":default:u=e.bottom+12,c=e.left+e.width/2-a.width/2;break}u=Math.max(12,Math.min(u,window.innerHeight-a.height-12)),c=Math.max(12,Math.min(c,window.innerWidth-a.width-12)),z({top:u+window.pageYOffset,left:c+window.pageXOffset}),F(j)};return r(),window.addEventListener("scroll",r),window.addEventListener("resize",r),()=>{window.removeEventListener("scroll",r),window.removeEventListener("resize",r)}},[s,p,l,f]),i.useEffect(()=>{if(!s)return;const r=e=>{switch(e.key){case"Escape":h();break;case"ArrowRight":case"Enter":case" ":e.key===" "&&e.preventDefault(),k();break;case"ArrowLeft":E();break}};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[s,n,d.length]),i.useEffect(()=>{if(s){const r=window.innerWidth-document.documentElement.clientWidth;document.body.style.overflow="hidden",document.body.style.paddingRight=`${r}px`}else document.body.style.overflow="",document.body.style.paddingRight="";return()=>{document.body.style.overflow="",document.body.style.paddingRight=""}},[s]);const k=()=>{n<d.length-1?x(n+1):(R?.(),h())},E=()=>{n>0&&x(n-1)},D=()=>{P?.(),h()},W=()=>{h()};if(!s||d.length===0)return null;const O=n===0,V=n===d.length-1;return X.createPortal(o.jsxs(o.Fragment,{children:[T&&o.jsx("div",{className:`${t.default.tourMask} ${t.default.tourMaskVisible}`,"aria-hidden":"true"}),o.jsxs("div",{ref:m,className:`${t.default.tourPopup} ${t.default.tourPopupVisible}`,style:{top:`${b.top}px`,left:`${b.left}px`},"data-placement":B,role:"dialog","aria-modal":"false","aria-label":$,"aria-describedby":"tour-content",children:[o.jsxs("div",{className:t.default.tourHeader,children:[q&&o.jsxs("div",{className:t.default.tourProgress,"aria-live":"polite",children:[n+1," / ",d.length]}),L&&o.jsx("button",{className:t.default.tourClose,onClick:W,"aria-label":"Close tour",children:o.jsx(K.X,{size:20})})]}),o.jsxs("div",{className:t.default.tourContent,id:"tour-content",children:[o.jsx("h4",{className:t.default.tourTitle,children:l.title}),o.jsx("div",{className:t.default.tourDescription,children:l.content})]}),o.jsxs("div",{className:t.default.tourFooter,children:[C?o.jsx(v.Button,{variant:"ghost",size:"sm",onClick:D,className:t.default.tourSkip,children:"Skip"}):o.jsx("span",{}),o.jsxs("div",{className:t.default.tourNav,children:[o.jsx(v.Button,{variant:"secondary",size:"sm",onClick:E,disabled:O,className:t.default.tourPrev,children:"Previous"}),o.jsx(v.Button,{variant:"primary",size:"sm",onClick:k,className:t.default.tourNext,children:V?"Finish":"Next"})]})]})]})]}),document.body)};N.displayName="Tour";exports.Tour=N;
//# sourceMappingURL=Tour.cjs.map
